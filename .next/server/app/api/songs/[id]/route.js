"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/songs/[id]/route";
exports.ids = ["app/api/songs/[id]/route"];
exports.modules = {

/***/ "@aws-sdk/client-s3":
/*!*************************************!*\
  !*** external "@aws-sdk/client-s3" ***!
  \*************************************/
/***/ ((module) => {

module.exports = require("@aws-sdk/client-s3");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "http2":
/*!************************!*\
  !*** external "http2" ***!
  \************************/
/***/ ((module) => {

module.exports = require("http2");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:path":
/*!****************************!*\
  !*** external "node:path" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("node:path");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsongs%2F%5Bid%5D%2Froute&page=%2Fapi%2Fsongs%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsongs%2F%5Bid%5D%2Froute.ts&appDir=%2FUsers%2Faditysaib%2FDocuments%2FVibe-loop%20copy%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Faditysaib%2FDocuments%2FVibe-loop%20copy&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsongs%2F%5Bid%5D%2Froute&page=%2Fapi%2Fsongs%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsongs%2F%5Bid%5D%2Froute.ts&appDir=%2FUsers%2Faditysaib%2FDocuments%2FVibe-loop%20copy%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Faditysaib%2FDocuments%2FVibe-loop%20copy&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_aditysaib_Documents_Vibe_loop_copy_app_api_songs_id_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/songs/[id]/route.ts */ \"(rsc)/./app/api/songs/[id]/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/songs/[id]/route\",\n        pathname: \"/api/songs/[id]\",\n        filename: \"route\",\n        bundlePath: \"app/api/songs/[id]/route\"\n    },\n    resolvedPagePath: \"/Users/aditysaib/Documents/Vibe-loop copy/app/api/songs/[id]/route.ts\",\n    nextConfigOutput,\n    userland: _Users_aditysaib_Documents_Vibe_loop_copy_app_api_songs_id_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/songs/[id]/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzb25ncyUyRiU1QmlkJTVEJTJGcm91dGUmcGFnZT0lMkZhcGklMkZzb25ncyUyRiU1QmlkJTVEJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGc29uZ3MlMkYlNUJpZCU1RCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmFkaXR5c2FpYiUyRkRvY3VtZW50cyUyRlZpYmUtbG9vcCUyMGNvcHklMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGYWRpdHlzYWliJTJGRG9jdW1lbnRzJTJGVmliZS1sb29wJTIwY29weSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDcUI7QUFDbEc7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92aWJlbG9vcC8/OWJiNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvYWRpdHlzYWliL0RvY3VtZW50cy9WaWJlLWxvb3AgY29weS9hcHAvYXBpL3NvbmdzL1tpZF0vcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3NvbmdzL1tpZF0vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9zb25ncy9baWRdXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9zb25ncy9baWRdL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL2FkaXR5c2FpYi9Eb2N1bWVudHMvVmliZS1sb29wIGNvcHkvYXBwL2FwaS9zb25ncy9baWRdL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9zb25ncy9baWRdL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsongs%2F%5Bid%5D%2Froute&page=%2Fapi%2Fsongs%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsongs%2F%5Bid%5D%2Froute.ts&appDir=%2FUsers%2Faditysaib%2FDocuments%2FVibe-loop%20copy%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Faditysaib%2FDocuments%2FVibe-loop%20copy&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/songs/[id]/route.ts":
/*!*************************************!*\
  !*** ./app/api/songs/[id]/route.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PATCH: () => (/* binding */ PATCH)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_s3_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/s3-service */ \"(rsc)/./lib/s3-service.ts\");\n/* harmony import */ var _clerk_nextjs_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @clerk/nextjs/server */ \"(rsc)/./node_modules/@clerk/nextjs/dist/esm/app-router/server/auth.js\");\n\n\n\nasync function PATCH(request, { params }) {\n    try {\n        const songId = params.id;\n        const { action } = await request.json();\n        if (action !== \"like\") {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid action\"\n            }, {\n                status: 400\n            });\n        }\n        // Get userId from Clerk\n        const { userId } = await (0,_clerk_nextjs_server__WEBPACK_IMPORTED_MODULE_2__.auth)();\n        if (!userId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Not authenticated\"\n            }, {\n                status: 401\n            });\n        }\n        // Get current metadata\n        const metadata = await (0,_lib_s3_service__WEBPACK_IMPORTED_MODULE_1__.getSongMetadata)(songId);\n        if (!metadata) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Song not found\"\n            }, {\n                status: 404\n            });\n        }\n        // Check if user already liked\n        const alreadyLiked = await (0,_lib_s3_service__WEBPACK_IMPORTED_MODULE_1__.hasUserLikedSong)(songId, userId);\n        if (alreadyLiked) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"You have already liked this song.\"\n            }, {\n                status: 400\n            });\n        }\n        // Add like\n        const newLikes = await (0,_lib_s3_service__WEBPACK_IMPORTED_MODULE_1__.addUserLikeToSong)(songId, userId);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: \"Song liked successfully\",\n            likes: newLikes\n        });\n    } catch (error) {\n        console.error(\"Error updating song:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to update song\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3NvbmdzL1tpZF0vcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUE0RDtBQUMyQjtBQUMzQztBQUVyQyxlQUFlSyxNQUNwQkMsT0FBb0IsRUFDcEIsRUFBRUMsTUFBTSxFQUE4QjtJQUV0QyxJQUFJO1FBQ0YsTUFBTUMsU0FBU0QsT0FBT0UsRUFBRTtRQUN4QixNQUFNLEVBQUVDLE1BQU0sRUFBRSxHQUFHLE1BQU1KLFFBQVFLLElBQUk7UUFFckMsSUFBSUQsV0FBVyxRQUFRO1lBQ3JCLE9BQU9WLHFEQUFZQSxDQUFDVyxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBaUIsR0FBRztnQkFBRUMsUUFBUTtZQUFJO1FBQ3RFO1FBRUEsd0JBQXdCO1FBQ3hCLE1BQU0sRUFBRUMsTUFBTSxFQUFFLEdBQUcsTUFBTVYsMERBQUlBO1FBQzdCLElBQUksQ0FBQ1UsUUFBUTtZQUNYLE9BQU9kLHFEQUFZQSxDQUFDVyxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBb0IsR0FBRztnQkFBRUMsUUFBUTtZQUFJO1FBQ3pFO1FBRUEsdUJBQXVCO1FBQ3ZCLE1BQU1FLFdBQVcsTUFBTVosZ0VBQWVBLENBQUNLO1FBQ3ZDLElBQUksQ0FBQ08sVUFBVTtZQUNiLE9BQU9mLHFEQUFZQSxDQUFDVyxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBaUIsR0FBRztnQkFBRUMsUUFBUTtZQUFJO1FBQ3RFO1FBRUEsOEJBQThCO1FBQzlCLE1BQU1HLGVBQWUsTUFBTWQsaUVBQWdCQSxDQUFDTSxRQUFRTTtRQUNwRCxJQUFJRSxjQUFjO1lBQ2hCLE9BQU9oQixxREFBWUEsQ0FBQ1csSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQW9DLEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUN6RjtRQUVBLFdBQVc7UUFDWCxNQUFNSSxXQUFXLE1BQU1oQixrRUFBaUJBLENBQUNPLFFBQVFNO1FBRWpELE9BQU9kLHFEQUFZQSxDQUFDVyxJQUFJLENBQUM7WUFDdkJPLFNBQVM7WUFDVEMsT0FBT0Y7UUFDVDtJQUNGLEVBQUUsT0FBT0wsT0FBTztRQUNkUSxRQUFRUixLQUFLLENBQUMsd0JBQXdCQTtRQUN0QyxPQUFPWixxREFBWUEsQ0FBQ1csSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBd0IsR0FBRztZQUFFQyxRQUFRO1FBQUk7SUFDN0U7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3ZpYmVsb29wLy4vYXBwL2FwaS9zb25ncy9baWRdL3JvdXRlLnRzPzM1YTYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdHlwZSBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCJcbmltcG9ydCB7IGFkZFVzZXJMaWtlVG9Tb25nLCBoYXNVc2VyTGlrZWRTb25nLCBnZXRTb25nTWV0YWRhdGEgfSBmcm9tIFwiQC9saWIvczMtc2VydmljZVwiXG5pbXBvcnQgeyBhdXRoIH0gZnJvbSAnQGNsZXJrL25leHRqcy9zZXJ2ZXInO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUEFUQ0goXG4gIHJlcXVlc3Q6IE5leHRSZXF1ZXN0LFxuICB7IHBhcmFtcyB9OiB7IHBhcmFtczogeyBpZDogc3RyaW5nIH0gfVxuKSB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc29uZ0lkID0gcGFyYW1zLmlkXG4gICAgY29uc3QgeyBhY3Rpb24gfSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG5cbiAgICBpZiAoYWN0aW9uICE9PSAnbGlrZScpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnSW52YWxpZCBhY3Rpb24nIH0sIHsgc3RhdHVzOiA0MDAgfSlcbiAgICB9XG5cbiAgICAvLyBHZXQgdXNlcklkIGZyb20gQ2xlcmtcbiAgICBjb25zdCB7IHVzZXJJZCB9ID0gYXdhaXQgYXV0aCgpO1xuICAgIGlmICghdXNlcklkKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ05vdCBhdXRoZW50aWNhdGVkJyB9LCB7IHN0YXR1czogNDAxIH0pO1xuICAgIH1cblxuICAgIC8vIEdldCBjdXJyZW50IG1ldGFkYXRhXG4gICAgY29uc3QgbWV0YWRhdGEgPSBhd2FpdCBnZXRTb25nTWV0YWRhdGEoc29uZ0lkKVxuICAgIGlmICghbWV0YWRhdGEpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnU29uZyBub3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDQgfSlcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiB1c2VyIGFscmVhZHkgbGlrZWRcbiAgICBjb25zdCBhbHJlYWR5TGlrZWQgPSBhd2FpdCBoYXNVc2VyTGlrZWRTb25nKHNvbmdJZCwgdXNlcklkKTtcbiAgICBpZiAoYWxyZWFkeUxpa2VkKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1lvdSBoYXZlIGFscmVhZHkgbGlrZWQgdGhpcyBzb25nLicgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICB9XG5cbiAgICAvLyBBZGQgbGlrZVxuICAgIGNvbnN0IG5ld0xpa2VzID0gYXdhaXQgYWRkVXNlckxpa2VUb1Nvbmcoc29uZ0lkLCB1c2VySWQpO1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICBtZXNzYWdlOiAnU29uZyBsaWtlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgbGlrZXM6IG5ld0xpa2VzIFxuICAgIH0pXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgc29uZzonLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0ZhaWxlZCB0byB1cGRhdGUgc29uZycgfSwgeyBzdGF0dXM6IDUwMCB9KVxuICB9XG59ICJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJhZGRVc2VyTGlrZVRvU29uZyIsImhhc1VzZXJMaWtlZFNvbmciLCJnZXRTb25nTWV0YWRhdGEiLCJhdXRoIiwiUEFUQ0giLCJyZXF1ZXN0IiwicGFyYW1zIiwic29uZ0lkIiwiaWQiLCJhY3Rpb24iLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJ1c2VySWQiLCJtZXRhZGF0YSIsImFscmVhZHlMaWtlZCIsIm5ld0xpa2VzIiwibWVzc2FnZSIsImxpa2VzIiwiY29uc29sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/songs/[id]/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/s3-service.ts":
/*!***************************!*\
  !*** ./lib/s3-service.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addUserLikeToSong: () => (/* binding */ addUserLikeToSong),\n/* harmony export */   deleteSong: () => (/* binding */ deleteSong),\n/* harmony export */   generateSongId: () => (/* binding */ generateSongId),\n/* harmony export */   getAllMoodLogs: () => (/* binding */ getAllMoodLogs),\n/* harmony export */   getAllSongs: () => (/* binding */ getAllSongs),\n/* harmony export */   getAudioUrl: () => (/* binding */ getAudioUrl),\n/* harmony export */   getSongMetadata: () => (/* binding */ getSongMetadata),\n/* harmony export */   hasUserLikedSong: () => (/* binding */ hasUserLikedSong),\n/* harmony export */   storeMoodLog: () => (/* binding */ storeMoodLog),\n/* harmony export */   storeSongMetadata: () => (/* binding */ storeSongMetadata),\n/* harmony export */   updateSongLikes: () => (/* binding */ updateSongLikes),\n/* harmony export */   uploadAudioFile: () => (/* binding */ uploadAudioFile)\n/* harmony export */ });\n/* harmony import */ var _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aws-sdk/client-s3 */ \"@aws-sdk/client-s3\");\n/* harmony import */ var _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _aws_sdk_s3_request_presigner__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @aws-sdk/s3-request-presigner */ \"(rsc)/./node_modules/@aws-sdk/s3-request-presigner/dist-es/index.js\");\n\n\n// S3 Client configuration\nconst s3Client = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.S3Client({\n    endpoint: \"https://hel1.your-objectstorage.com\",\n    region: \"eu-central-1\",\n    credentials: {\n        accessKeyId: \"1BY6DNARWDPSQT4DXA18\",\n        secretAccessKey: \"ieGy5o6biNPCc09iKbE55sPe01JywW8u5pFpnk8J\"\n    },\n    forcePathStyle: \"false\" === \"true\"\n});\nconst BUCKET_NAME = \"serenidad\";\n// Upload audio file to S3\nasync function uploadAudioFile(songId, file, contentType = \"audio/mpeg\") {\n    const key = `audio/${songId}.mp3`;\n    const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.PutObjectCommand({\n        Bucket: BUCKET_NAME,\n        Key: key,\n        Body: file,\n        ContentType: contentType\n    });\n    await s3Client.send(command);\n    return key;\n}\n// Store song metadata as JSON file in S3\nasync function storeSongMetadata(songId, metadata) {\n    const key = `metadata/${songId}.json`;\n    const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.PutObjectCommand({\n        Bucket: BUCKET_NAME,\n        Key: key,\n        Body: JSON.stringify(metadata),\n        ContentType: \"application/json\"\n    });\n    await s3Client.send(command);\n}\n// Get song metadata from S3\nasync function getSongMetadata(songId) {\n    try {\n        const key = `metadata/${songId}.json`;\n        const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.GetObjectCommand({\n            Bucket: BUCKET_NAME,\n            Key: key\n        });\n        const response = await s3Client.send(command);\n        const body = await response.Body?.transformToString();\n        return body ? JSON.parse(body) : null;\n    } catch (error) {\n        console.error(\"Error getting metadata:\", error);\n        return null;\n    }\n}\n// Get signed URL for audio streaming\nasync function getAudioUrl(songId) {\n    const key = `audio/${songId}.mp3`;\n    const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.GetObjectCommand({\n        Bucket: BUCKET_NAME,\n        Key: key\n    });\n    // URL expires in 1 hour\n    return await (0,_aws_sdk_s3_request_presigner__WEBPACK_IMPORTED_MODULE_1__.getSignedUrl)(s3Client, command, {\n        expiresIn: 3600\n    });\n}\n// List all songs with metadata\nasync function getAllSongs() {\n    try {\n        // List all metadata files\n        const listCommand = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.ListObjectsV2Command({\n            Bucket: BUCKET_NAME,\n            Prefix: \"metadata/\"\n        });\n        const response = await s3Client.send(listCommand);\n        const objects = response.Contents || [];\n        // If no objects found, return empty array (this is normal for new buckets)\n        if (!objects.length) {\n            return [];\n        }\n        const songs = [];\n        for (const object of objects){\n            if (object.Key && object.Key.endsWith(\".json\")) {\n                const songId = object.Key.replace(\"metadata/\", \"\").replace(\".json\", \"\");\n                const metadata = await getSongMetadata(songId);\n                if (metadata) {\n                    try {\n                        const audioUrl = await getAudioUrl(songId);\n                        songs.push({\n                            id: songId,\n                            title: metadata.title,\n                            artist: metadata.artist,\n                            audioUrl,\n                            likes: metadata.likes,\n                            uploadedAt: metadata.uploadedAt\n                        });\n                    } catch (audioError) {\n                        console.warn(`Could not get audio URL for song ${songId}:`, audioError);\n                    }\n                }\n            }\n        }\n        // Sort by upload date (newest first)\n        return songs.sort((a, b)=>new Date(b.uploadedAt).getTime() - new Date(a.uploadedAt).getTime());\n    } catch (error) {\n        // Handle the case where bucket is empty or metadata prefix doesn't exist\n        if (error.name === \"NoSuchKey\" || error.Code === \"NoSuchKey\") {\n            return [];\n        }\n        console.error(\"Error listing songs:\", error);\n        return [];\n    }\n}\n// Update song likes\nasync function updateSongLikes(songId, likes) {\n    const metadata = await getSongMetadata(songId);\n    if (metadata) {\n        metadata.likes = likes;\n        await storeSongMetadata(songId, metadata);\n    }\n}\n// Delete song and its metadata\nasync function deleteSong(songId) {\n    const audioKey = `audio/${songId}.mp3`;\n    const metadataKey = `metadata/${songId}.json`;\n    await Promise.all([\n        s3Client.send(new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.DeleteObjectCommand({\n            Bucket: BUCKET_NAME,\n            Key: audioKey\n        })),\n        s3Client.send(new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.DeleteObjectCommand({\n            Bucket: BUCKET_NAME,\n            Key: metadataKey\n        }))\n    ]);\n}\n// Generate unique song ID\nfunction generateSongId() {\n    return `song_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n}\n// Store mood log as JSON file in S3\nasync function storeMoodLog(log) {\n    const id = `mood_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    const key = `mood-logs/${id}.json`;\n    const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.PutObjectCommand({\n        Bucket: BUCKET_NAME,\n        Key: key,\n        Body: JSON.stringify(log),\n        ContentType: \"application/json\"\n    });\n    await s3Client.send(command);\n}\n// List all mood logs from S3\nasync function getAllMoodLogs() {\n    try {\n        const listCommand = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.ListObjectsV2Command({\n            Bucket: BUCKET_NAME,\n            Prefix: \"mood-logs/\"\n        });\n        const response = await s3Client.send(listCommand);\n        const objects = response.Contents || [];\n        if (!objects.length) return [];\n        const logs = [];\n        for (const object of objects){\n            if (object.Key && object.Key.endsWith(\".json\")) {\n                const getCommand = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.GetObjectCommand({\n                    Bucket: BUCKET_NAME,\n                    Key: object.Key\n                });\n                const res = await s3Client.send(getCommand);\n                const body = await res.Body?.transformToString();\n                if (body) {\n                    try {\n                        logs.push(JSON.parse(body));\n                    } catch  {}\n                }\n            }\n        }\n        // Sort by time (newest first)\n        return logs.sort((a, b)=>new Date(b.time).getTime() - new Date(a.time).getTime());\n    } catch (error) {\n        console.error(\"Error listing mood logs:\", error);\n        return [];\n    }\n}\n// Check if a user has already liked a song\nasync function hasUserLikedSong(songId, userId) {\n    const metadata = await getSongMetadata(songId);\n    if (!metadata) return false;\n    return Array.isArray(metadata.likedBy) && metadata.likedBy.includes(userId);\n}\n// Add a user's like to a song (if not already liked)\nasync function addUserLikeToSong(songId, userId) {\n    const metadata = await getSongMetadata(songId);\n    if (!metadata) return null;\n    if (!Array.isArray(metadata.likedBy)) metadata.likedBy = [];\n    if (!metadata.likedBy.includes(userId)) {\n        metadata.likedBy.push(userId);\n        metadata.likes = (metadata.likes || 0) + 1;\n        await storeSongMetadata(songId, metadata);\n        return metadata.likes;\n    }\n    return metadata.likes;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxRQUFRLENBQUNKO0FBQ3RFO0FBRUEscURBQXFEO0FBQzlDLGVBQWVLLGtCQUFrQjFFLE1BQWMsRUFBRXFFLE1BQWM7SUFDcEUsTUFBTTFELFdBQVcsTUFBTUcsZ0JBQWdCZDtJQUN2QyxJQUFJLENBQUNXLFVBQVUsT0FBTztJQUN0QixJQUFJLENBQUMyRCxNQUFNQyxPQUFPLENBQUM1RCxTQUFTNkQsT0FBTyxHQUFHN0QsU0FBUzZELE9BQU8sR0FBRyxFQUFFO0lBQzNELElBQUksQ0FBQzdELFNBQVM2RCxPQUFPLENBQUNDLFFBQVEsQ0FBQ0osU0FBUztRQUN0QzFELFNBQVM2RCxPQUFPLENBQUN0QyxJQUFJLENBQUNtQztRQUN0QjFELFNBQVMyQixLQUFLLEdBQUcsQ0FBQzNCLFNBQVMyQixLQUFLLElBQUksS0FBSztRQUN6QyxNQUFNNUIsa0JBQWtCVixRQUFRVztRQUNoQyxPQUFPQSxTQUFTMkIsS0FBSztJQUN2QjtJQUNBLE9BQU8zQixTQUFTMkIsS0FBSztBQUN2QiIsInNvdXJjZXMiOlsid2VicGFjazovL3ZpYmVsb29wLy4vbGliL3MzLXNlcnZpY2UudHM/MGRjMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTM0NsaWVudCwgUHV0T2JqZWN0Q29tbWFuZCwgR2V0T2JqZWN0Q29tbWFuZCwgTGlzdE9iamVjdHNWMkNvbW1hbmQsIERlbGV0ZU9iamVjdENvbW1hbmQgfSBmcm9tICdAYXdzLXNkay9jbGllbnQtczMnXG5pbXBvcnQgeyBnZXRTaWduZWRVcmwgfSBmcm9tICdAYXdzLXNkay9zMy1yZXF1ZXN0LXByZXNpZ25lcidcblxuLy8gUzMgQ2xpZW50IGNvbmZpZ3VyYXRpb25cbmNvbnN0IHMzQ2xpZW50ID0gbmV3IFMzQ2xpZW50KHtcbiAgZW5kcG9pbnQ6IHByb2Nlc3MuZW52LlMzX0VORFBPSU5ULFxuICByZWdpb246IHByb2Nlc3MuZW52LlMzX1JFR0lPTixcbiAgY3JlZGVudGlhbHM6IHtcbiAgICBhY2Nlc3NLZXlJZDogcHJvY2Vzcy5lbnYuUzNfQUNDRVNTX0tFWV9JRCEsXG4gICAgc2VjcmV0QWNjZXNzS2V5OiBwcm9jZXNzLmVudi5TM19TRUNSRVRfQUNDRVNTX0tFWSEsXG4gIH0sXG4gIGZvcmNlUGF0aFN0eWxlOiBwcm9jZXNzLmVudi5TM19GT1JDRV9QQVRIX1NUWUxFID09PSAndHJ1ZScsXG59KVxuXG5jb25zdCBCVUNLRVRfTkFNRSA9IHByb2Nlc3MuZW52LlMzX0JVQ0tFVF9OQU1FIVxuXG5leHBvcnQgaW50ZXJmYWNlIFNvbmcge1xuICBpZDogc3RyaW5nXG4gIHRpdGxlOiBzdHJpbmdcbiAgYXJ0aXN0OiBzdHJpbmdcbiAgYXVkaW9Vcmw6IHN0cmluZ1xuICBsaWtlczogbnVtYmVyXG4gIHVwbG9hZGVkQXQ6IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNvbmdNZXRhZGF0YSB7XG4gIHRpdGxlOiBzdHJpbmdcbiAgYXJ0aXN0OiBzdHJpbmdcbiAgbGlrZXM6IG51bWJlclxuICB1cGxvYWRlZEF0OiBzdHJpbmdcbiAgbGlrZWRCeT86IHN0cmluZ1tdIC8vIGFycmF5IG9mIHVzZXIgSURzIHdobyBsaWtlZCB0aGlzIHNvbmdcbn1cblxuLy8gVXBsb2FkIGF1ZGlvIGZpbGUgdG8gUzNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGxvYWRBdWRpb0ZpbGUoXG4gIHNvbmdJZDogc3RyaW5nLFxuICBmaWxlOiBCdWZmZXIsXG4gIGNvbnRlbnRUeXBlOiBzdHJpbmcgPSAnYXVkaW8vbXBlZydcbik6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IGtleSA9IGBhdWRpby8ke3NvbmdJZH0ubXAzYFxuICBcbiAgY29uc3QgY29tbWFuZCA9IG5ldyBQdXRPYmplY3RDb21tYW5kKHtcbiAgICBCdWNrZXQ6IEJVQ0tFVF9OQU1FLFxuICAgIEtleToga2V5LFxuICAgIEJvZHk6IGZpbGUsXG4gICAgQ29udGVudFR5cGU6IGNvbnRlbnRUeXBlLFxuICB9KVxuXG4gIGF3YWl0IHMzQ2xpZW50LnNlbmQoY29tbWFuZClcbiAgcmV0dXJuIGtleVxufVxuXG4vLyBTdG9yZSBzb25nIG1ldGFkYXRhIGFzIEpTT04gZmlsZSBpbiBTM1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN0b3JlU29uZ01ldGFkYXRhKHNvbmdJZDogc3RyaW5nLCBtZXRhZGF0YTogU29uZ01ldGFkYXRhKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IGtleSA9IGBtZXRhZGF0YS8ke3NvbmdJZH0uanNvbmBcbiAgXG4gIGNvbnN0IGNvbW1hbmQgPSBuZXcgUHV0T2JqZWN0Q29tbWFuZCh7XG4gICAgQnVja2V0OiBCVUNLRVRfTkFNRSxcbiAgICBLZXk6IGtleSxcbiAgICBCb2R5OiBKU09OLnN0cmluZ2lmeShtZXRhZGF0YSksXG4gICAgQ29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgfSlcblxuICBhd2FpdCBzM0NsaWVudC5zZW5kKGNvbW1hbmQpXG59XG5cbi8vIEdldCBzb25nIG1ldGFkYXRhIGZyb20gUzNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTb25nTWV0YWRhdGEoc29uZ0lkOiBzdHJpbmcpOiBQcm9taXNlPFNvbmdNZXRhZGF0YSB8IG51bGw+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBrZXkgPSBgbWV0YWRhdGEvJHtzb25nSWR9Lmpzb25gXG4gICAgXG4gICAgY29uc3QgY29tbWFuZCA9IG5ldyBHZXRPYmplY3RDb21tYW5kKHtcbiAgICAgIEJ1Y2tldDogQlVDS0VUX05BTUUsXG4gICAgICBLZXk6IGtleSxcbiAgICB9KVxuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzM0NsaWVudC5zZW5kKGNvbW1hbmQpXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlc3BvbnNlLkJvZHk/LnRyYW5zZm9ybVRvU3RyaW5nKClcbiAgICBcbiAgICByZXR1cm4gYm9keSA/IEpTT04ucGFyc2UoYm9keSkgOiBudWxsXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBtZXRhZGF0YTonLCBlcnJvcilcbiAgICByZXR1cm4gbnVsbFxuICB9XG59XG5cbi8vIEdldCBzaWduZWQgVVJMIGZvciBhdWRpbyBzdHJlYW1pbmdcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBdWRpb1VybChzb25nSWQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IGtleSA9IGBhdWRpby8ke3NvbmdJZH0ubXAzYFxuICBcbiAgY29uc3QgY29tbWFuZCA9IG5ldyBHZXRPYmplY3RDb21tYW5kKHtcbiAgICBCdWNrZXQ6IEJVQ0tFVF9OQU1FLFxuICAgIEtleToga2V5LFxuICB9KVxuXG4gIC8vIFVSTCBleHBpcmVzIGluIDEgaG91clxuICByZXR1cm4gYXdhaXQgZ2V0U2lnbmVkVXJsKHMzQ2xpZW50LCBjb21tYW5kLCB7IGV4cGlyZXNJbjogMzYwMCB9KVxufVxuXG4vLyBMaXN0IGFsbCBzb25ncyB3aXRoIG1ldGFkYXRhXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsU29uZ3MoKTogUHJvbWlzZTxTb25nW10+IHtcbiAgdHJ5IHtcbiAgICAvLyBMaXN0IGFsbCBtZXRhZGF0YSBmaWxlc1xuICAgIGNvbnN0IGxpc3RDb21tYW5kID0gbmV3IExpc3RPYmplY3RzVjJDb21tYW5kKHtcbiAgICAgIEJ1Y2tldDogQlVDS0VUX05BTUUsXG4gICAgICBQcmVmaXg6ICdtZXRhZGF0YS8nLFxuICAgIH0pXG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHMzQ2xpZW50LnNlbmQobGlzdENvbW1hbmQpXG4gICAgY29uc3Qgb2JqZWN0cyA9IHJlc3BvbnNlLkNvbnRlbnRzIHx8IFtdXG5cbiAgICAvLyBJZiBubyBvYmplY3RzIGZvdW5kLCByZXR1cm4gZW1wdHkgYXJyYXkgKHRoaXMgaXMgbm9ybWFsIGZvciBuZXcgYnVja2V0cylcbiAgICBpZiAoIW9iamVjdHMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gW11cbiAgICB9XG5cbiAgICBjb25zdCBzb25nczogU29uZ1tdID0gW11cblxuICAgIGZvciAoY29uc3Qgb2JqZWN0IG9mIG9iamVjdHMpIHtcbiAgICAgIGlmIChvYmplY3QuS2V5ICYmIG9iamVjdC5LZXkuZW5kc1dpdGgoJy5qc29uJykpIHtcbiAgICAgICAgY29uc3Qgc29uZ0lkID0gb2JqZWN0LktleS5yZXBsYWNlKCdtZXRhZGF0YS8nLCAnJykucmVwbGFjZSgnLmpzb24nLCAnJylcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG1ldGFkYXRhID0gYXdhaXQgZ2V0U29uZ01ldGFkYXRhKHNvbmdJZClcbiAgICAgICAgXG4gICAgICAgIGlmIChtZXRhZGF0YSkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBhdWRpb1VybCA9IGF3YWl0IGdldEF1ZGlvVXJsKHNvbmdJZClcbiAgICAgICAgICAgIHNvbmdzLnB1c2goe1xuICAgICAgICAgICAgICBpZDogc29uZ0lkLFxuICAgICAgICAgICAgICB0aXRsZTogbWV0YWRhdGEudGl0bGUsXG4gICAgICAgICAgICAgIGFydGlzdDogbWV0YWRhdGEuYXJ0aXN0LFxuICAgICAgICAgICAgICBhdWRpb1VybCxcbiAgICAgICAgICAgICAgbGlrZXM6IG1ldGFkYXRhLmxpa2VzLFxuICAgICAgICAgICAgICB1cGxvYWRlZEF0OiBtZXRhZGF0YS51cGxvYWRlZEF0LFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9IGNhdGNoIChhdWRpb0Vycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYENvdWxkIG5vdCBnZXQgYXVkaW8gVVJMIGZvciBzb25nICR7c29uZ0lkfTpgLCBhdWRpb0Vycm9yKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBTb3J0IGJ5IHVwbG9hZCBkYXRlIChuZXdlc3QgZmlyc3QpXG4gICAgcmV0dXJuIHNvbmdzLnNvcnQoKGEsIGIpID0+IG5ldyBEYXRlKGIudXBsb2FkZWRBdCkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYS51cGxvYWRlZEF0KS5nZXRUaW1lKCkpXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAvLyBIYW5kbGUgdGhlIGNhc2Ugd2hlcmUgYnVja2V0IGlzIGVtcHR5IG9yIG1ldGFkYXRhIHByZWZpeCBkb2Vzbid0IGV4aXN0XG4gICAgaWYgKGVycm9yLm5hbWUgPT09ICdOb1N1Y2hLZXknIHx8IGVycm9yLkNvZGUgPT09ICdOb1N1Y2hLZXknKSB7XG4gICAgICByZXR1cm4gW11cbiAgICB9XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlzdGluZyBzb25nczonLCBlcnJvcilcbiAgICByZXR1cm4gW11cbiAgfVxufVxuXG4vLyBVcGRhdGUgc29uZyBsaWtlc1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVNvbmdMaWtlcyhzb25nSWQ6IHN0cmluZywgbGlrZXM6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBtZXRhZGF0YSA9IGF3YWl0IGdldFNvbmdNZXRhZGF0YShzb25nSWQpXG4gIGlmIChtZXRhZGF0YSkge1xuICAgIG1ldGFkYXRhLmxpa2VzID0gbGlrZXNcbiAgICBhd2FpdCBzdG9yZVNvbmdNZXRhZGF0YShzb25nSWQsIG1ldGFkYXRhKVxuICB9XG59XG5cbi8vIERlbGV0ZSBzb25nIGFuZCBpdHMgbWV0YWRhdGFcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVTb25nKHNvbmdJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IGF1ZGlvS2V5ID0gYGF1ZGlvLyR7c29uZ0lkfS5tcDNgXG4gIGNvbnN0IG1ldGFkYXRhS2V5ID0gYG1ldGFkYXRhLyR7c29uZ0lkfS5qc29uYFxuXG4gIGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICBzM0NsaWVudC5zZW5kKG5ldyBEZWxldGVPYmplY3RDb21tYW5kKHsgQnVja2V0OiBCVUNLRVRfTkFNRSwgS2V5OiBhdWRpb0tleSB9KSksXG4gICAgczNDbGllbnQuc2VuZChuZXcgRGVsZXRlT2JqZWN0Q29tbWFuZCh7IEJ1Y2tldDogQlVDS0VUX05BTUUsIEtleTogbWV0YWRhdGFLZXkgfSkpXG4gIF0pXG59XG5cbi8vIEdlbmVyYXRlIHVuaXF1ZSBzb25nIElEXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVTb25nSWQoKTogc3RyaW5nIHtcbiAgcmV0dXJuIGBzb25nXyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YFxufVxuXG4vLyBTdG9yZSBtb29kIGxvZyBhcyBKU09OIGZpbGUgaW4gUzNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdG9yZU1vb2RMb2cobG9nOiB7IGVtb2ppOiBzdHJpbmc7IHRleHQ6IHN0cmluZzsgdGltZTogc3RyaW5nIH0pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgaWQgPSBgbW9vZF8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWA7XG4gIGNvbnN0IGtleSA9IGBtb29kLWxvZ3MvJHtpZH0uanNvbmA7XG4gIGNvbnN0IGNvbW1hbmQgPSBuZXcgUHV0T2JqZWN0Q29tbWFuZCh7XG4gICAgQnVja2V0OiBCVUNLRVRfTkFNRSxcbiAgICBLZXk6IGtleSxcbiAgICBCb2R5OiBKU09OLnN0cmluZ2lmeShsb2cpLFxuICAgIENvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vanNvbicsXG4gIH0pO1xuICBhd2FpdCBzM0NsaWVudC5zZW5kKGNvbW1hbmQpO1xufVxuXG4vLyBMaXN0IGFsbCBtb29kIGxvZ3MgZnJvbSBTM1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbE1vb2RMb2dzKCk6IFByb21pc2U8e2Vtb2ppOiBzdHJpbmcsIHRleHQ6IHN0cmluZywgdGltZTogc3RyaW5nfVtdPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgbGlzdENvbW1hbmQgPSBuZXcgTGlzdE9iamVjdHNWMkNvbW1hbmQoe1xuICAgICAgQnVja2V0OiBCVUNLRVRfTkFNRSxcbiAgICAgIFByZWZpeDogJ21vb2QtbG9ncy8nLFxuICAgIH0pO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgczNDbGllbnQuc2VuZChsaXN0Q29tbWFuZCk7XG4gICAgY29uc3Qgb2JqZWN0cyA9IHJlc3BvbnNlLkNvbnRlbnRzIHx8IFtdO1xuICAgIGlmICghb2JqZWN0cy5sZW5ndGgpIHJldHVybiBbXTtcbiAgICBjb25zdCBsb2dzOiB7ZW1vamk6IHN0cmluZywgdGV4dDogc3RyaW5nLCB0aW1lOiBzdHJpbmd9W10gPSBbXTtcbiAgICBmb3IgKGNvbnN0IG9iamVjdCBvZiBvYmplY3RzKSB7XG4gICAgICBpZiAob2JqZWN0LktleSAmJiBvYmplY3QuS2V5LmVuZHNXaXRoKCcuanNvbicpKSB7XG4gICAgICAgIGNvbnN0IGdldENvbW1hbmQgPSBuZXcgR2V0T2JqZWN0Q29tbWFuZCh7XG4gICAgICAgICAgQnVja2V0OiBCVUNLRVRfTkFNRSxcbiAgICAgICAgICBLZXk6IG9iamVjdC5LZXksXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBzM0NsaWVudC5zZW5kKGdldENvbW1hbmQpO1xuICAgICAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVzLkJvZHk/LnRyYW5zZm9ybVRvU3RyaW5nKCk7XG4gICAgICAgIGlmIChib2R5KSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxvZ3MucHVzaChKU09OLnBhcnNlKGJvZHkpKTtcbiAgICAgICAgICB9IGNhdGNoIHt9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgLy8gU29ydCBieSB0aW1lIChuZXdlc3QgZmlyc3QpXG4gICAgcmV0dXJuIGxvZ3Muc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYi50aW1lKS5nZXRUaW1lKCkgLSBuZXcgRGF0ZShhLnRpbWUpLmdldFRpbWUoKSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlzdGluZyBtb29kIGxvZ3M6JywgZXJyb3IpO1xuICAgIHJldHVybiBbXTtcbiAgfVxufVxuXG4vLyBDaGVjayBpZiBhIHVzZXIgaGFzIGFscmVhZHkgbGlrZWQgYSBzb25nXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFzVXNlckxpa2VkU29uZyhzb25nSWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgY29uc3QgbWV0YWRhdGEgPSBhd2FpdCBnZXRTb25nTWV0YWRhdGEoc29uZ0lkKTtcbiAgaWYgKCFtZXRhZGF0YSkgcmV0dXJuIGZhbHNlO1xuICByZXR1cm4gQXJyYXkuaXNBcnJheShtZXRhZGF0YS5saWtlZEJ5KSAmJiBtZXRhZGF0YS5saWtlZEJ5LmluY2x1ZGVzKHVzZXJJZCk7XG59XG5cbi8vIEFkZCBhIHVzZXIncyBsaWtlIHRvIGEgc29uZyAoaWYgbm90IGFscmVhZHkgbGlrZWQpXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYWRkVXNlckxpa2VUb1Nvbmcoc29uZ0lkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxudW1iZXIgfCBudWxsPiB7XG4gIGNvbnN0IG1ldGFkYXRhID0gYXdhaXQgZ2V0U29uZ01ldGFkYXRhKHNvbmdJZCk7XG4gIGlmICghbWV0YWRhdGEpIHJldHVybiBudWxsO1xuICBpZiAoIUFycmF5LmlzQXJyYXkobWV0YWRhdGEubGlrZWRCeSkpIG1ldGFkYXRhLmxpa2VkQnkgPSBbXTtcbiAgaWYgKCFtZXRhZGF0YS5saWtlZEJ5LmluY2x1ZGVzKHVzZXJJZCkpIHtcbiAgICBtZXRhZGF0YS5saWtlZEJ5LnB1c2godXNlcklkKTtcbiAgICBtZXRhZGF0YS5saWtlcyA9IChtZXRhZGF0YS5saWtlcyB8fCAwKSArIDE7XG4gICAgYXdhaXQgc3RvcmVTb25nTWV0YWRhdGEoc29uZ0lkLCBtZXRhZGF0YSk7XG4gICAgcmV0dXJuIG1ldGFkYXRhLmxpa2VzO1xuICB9XG4gIHJldHVybiBtZXRhZGF0YS5saWtlcztcbn0gIl0sIm5hbWVzIjpbIlMzQ2xpZW50IiwiUHV0T2JqZWN0Q29tbWFuZCIsIkdldE9iamVjdENvbW1hbmQiLCJMaXN0T2JqZWN0c1YyQ29tbWFuZCIsIkRlbGV0ZU9iamVjdENvbW1hbmQiLCJnZXRTaWduZWRVcmwiLCJzM0NsaWVudCIsImVuZHBvaW50IiwicHJvY2VzcyIsImVudiIsIlMzX0VORFBPSU5UIiwicmVnaW9uIiwiUzNfUkVHSU9OIiwiY3JlZGVudGlhbHMiLCJhY2Nlc3NLZXlJZCIsIlMzX0FDQ0VTU19LRVlfSUQiLCJzZWNyZXRBY2Nlc3NLZXkiLCJTM19TRUNSRVRfQUNDRVNTX0tFWSIsImZvcmNlUGF0aFN0eWxlIiwiUzNfRk9SQ0VfUEFUSF9TVFlMRSIsIkJVQ0tFVF9OQU1FIiwiUzNfQlVDS0VUX05BTUUiLCJ1cGxvYWRBdWRpb0ZpbGUiLCJzb25nSWQiLCJmaWxlIiwiY29udGVudFR5cGUiLCJrZXkiLCJjb21tYW5kIiwiQnVja2V0IiwiS2V5IiwiQm9keSIsIkNvbnRlbnRUeXBlIiwic2VuZCIsInN0b3JlU29uZ01ldGFkYXRhIiwibWV0YWRhdGEiLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0U29uZ01ldGFkYXRhIiwicmVzcG9uc2UiLCJib2R5IiwidHJhbnNmb3JtVG9TdHJpbmciLCJwYXJzZSIsImVycm9yIiwiY29uc29sZSIsImdldEF1ZGlvVXJsIiwiZXhwaXJlc0luIiwiZ2V0QWxsU29uZ3MiLCJsaXN0Q29tbWFuZCIsIlByZWZpeCIsIm9iamVjdHMiLCJDb250ZW50cyIsImxlbmd0aCIsInNvbmdzIiwib2JqZWN0IiwiZW5kc1dpdGgiLCJyZXBsYWNlIiwiYXVkaW9VcmwiLCJwdXNoIiwiaWQiLCJ0aXRsZSIsImFydGlzdCIsImxpa2VzIiwidXBsb2FkZWRBdCIsImF1ZGlvRXJyb3IiLCJ3YXJuIiwic29ydCIsImEiLCJiIiwiRGF0ZSIsImdldFRpbWUiLCJuYW1lIiwiQ29kZSIsInVwZGF0ZVNvbmdMaWtlcyIsImRlbGV0ZVNvbmciLCJhdWRpb0tleSIsIm1ldGFkYXRhS2V5IiwiUHJvbWlzZSIsImFsbCIsImdlbmVyYXRlU29uZ0lkIiwibm93IiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyIiwic3RvcmVNb29kTG9nIiwibG9nIiwiZ2V0QWxsTW9vZExvZ3MiLCJsb2dzIiwiZ2V0Q29tbWFuZCIsInJlcyIsInRpbWUiLCJoYXNVc2VyTGlrZWRTb25nIiwidXNlcklkIiwiQXJyYXkiLCJpc0FycmF5IiwibGlrZWRCeSIsImluY2x1ZGVzIiwiYWRkVXNlckxpa2VUb1NvbmciXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/s3-service.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@clerk","vendor-chunks/next","vendor-chunks/tslib","vendor-chunks/cookie","vendor-chunks/map-obj","vendor-chunks/no-case","vendor-chunks/lower-case","vendor-chunks/snakecase-keys","vendor-chunks/snake-case","vendor-chunks/dot-case","vendor-chunks/@smithy","vendor-chunks/@aws-sdk"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsongs%2F%5Bid%5D%2Froute&page=%2Fapi%2Fsongs%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsongs%2F%5Bid%5D%2Froute.ts&appDir=%2FUsers%2Faditysaib%2FDocuments%2FVibe-loop%20copy%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Faditysaib%2FDocuments%2FVibe-loop%20copy&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();