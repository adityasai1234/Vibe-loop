"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/mood-log/route";
exports.ids = ["app/api/mood-log/route"];
exports.modules = {

/***/ "@aws-sdk/client-s3":
/*!*************************************!*\
  !*** external "@aws-sdk/client-s3" ***!
  \*************************************/
/***/ ((module) => {

module.exports = require("@aws-sdk/client-s3");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "http2":
/*!************************!*\
  !*** external "http2" ***!
  \************************/
/***/ ((module) => {

module.exports = require("http2");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "node:async_hooks":
/*!***********************************!*\
  !*** external "node:async_hooks" ***!
  \***********************************/
/***/ ((module) => {

module.exports = require("node:async_hooks");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:path":
/*!****************************!*\
  !*** external "node:path" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("node:path");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmood-log%2Froute&page=%2Fapi%2Fmood-log%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmood-log%2Froute.ts&appDir=%2FUsers%2Faditysaib%2FDocuments%2FVibe-loop%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Faditysaib%2FDocuments%2FVibe-loop&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmood-log%2Froute&page=%2Fapi%2Fmood-log%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmood-log%2Froute.ts&appDir=%2FUsers%2Faditysaib%2FDocuments%2FVibe-loop%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Faditysaib%2FDocuments%2FVibe-loop&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_aditysaib_Documents_Vibe_loop_app_api_mood_log_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/mood-log/route.ts */ \"(rsc)/./app/api/mood-log/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/mood-log/route\",\n        pathname: \"/api/mood-log\",\n        filename: \"route\",\n        bundlePath: \"app/api/mood-log/route\"\n    },\n    resolvedPagePath: \"/Users/aditysaib/Documents/Vibe-loop/app/api/mood-log/route.ts\",\n    nextConfigOutput,\n    userland: _Users_aditysaib_Documents_Vibe_loop_app_api_mood_log_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/mood-log/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZtb29kLWxvZyUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGbW9vZC1sb2clMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZtb29kLWxvZyUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmFkaXR5c2FpYiUyRkRvY3VtZW50cyUyRlZpYmUtbG9vcCUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZhZGl0eXNhaWIlMkZEb2N1bWVudHMlMkZWaWJlLWxvb3AmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ2M7QUFDM0Y7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92aWJlbG9vcC8/OWYzZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvYWRpdHlzYWliL0RvY3VtZW50cy9WaWJlLWxvb3AvYXBwL2FwaS9tb29kLWxvZy9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvbW9vZC1sb2cvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9tb29kLWxvZ1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvbW9vZC1sb2cvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvYWRpdHlzYWliL0RvY3VtZW50cy9WaWJlLWxvb3AvYXBwL2FwaS9tb29kLWxvZy9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvbW9vZC1sb2cvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmood-log%2Froute&page=%2Fapi%2Fmood-log%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmood-log%2Froute.ts&appDir=%2FUsers%2Faditysaib%2FDocuments%2FVibe-loop%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Faditysaib%2FDocuments%2FVibe-loop&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/mood-log/route.ts":
/*!***********************************!*\
  !*** ./app/api/mood-log/route.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_s3_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/s3-service */ \"(rsc)/./lib/s3-service.ts\");\n/* harmony import */ var _clerk_nextjs_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @clerk/nextjs/server */ \"(rsc)/./node_modules/@clerk/nextjs/dist/esm/app-router/server/currentUser.js\");\n\n\n\nasync function POST(request) {\n    try {\n        // Get user ID from Clerk\n        const user = await (0,_clerk_nextjs_server__WEBPACK_IMPORTED_MODULE_2__.currentUser)();\n        if (!user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Not authenticated\"\n            }, {\n                status: 401\n            });\n        }\n        const userId = user.id;\n        const { emoji, text, time } = await request.json();\n        if (!emoji || !text || !time) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Missing fields\"\n            }, {\n                status: 400\n            });\n        }\n        // Extract date from time (YYYY-MM-DD format)\n        const submittedDate = new Date(time);\n        const submittedDateStr = submittedDate.toISOString().split(\"T\")[0];\n        // Get today's date in UTC (YYYY-MM-DD)\n        const now = new Date();\n        const todayStr = now.toISOString().split(\"T\")[0];\n        // Only allow logging for today\n        if (submittedDateStr !== todayStr) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"You can only log your mood for today. Logging for past or future days is not allowed.\",\n                invalidDate: true\n            }, {\n                status: 400\n            });\n        }\n        // Check if user has already logged for this date\n        const alreadyLogged = await (0,_lib_s3_service__WEBPACK_IMPORTED_MODULE_1__.hasUserLoggedForDate)(userId, todayStr);\n        if (alreadyLogged) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"You have already logged your mood for today. You can only log once per day.\",\n                alreadyLogged: true\n            }, {\n                status: 400\n            });\n        }\n        // Store the mood log with user ID\n        await (0,_lib_s3_service__WEBPACK_IMPORTED_MODULE_1__.storeMoodLog)({\n            emoji,\n            text,\n            time,\n            userId\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: \"Mood log stored successfully\"\n        });\n    } catch (error) {\n        console.error(error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to store mood log\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function GET(request) {\n    try {\n        // Get user ID from Clerk\n        const user = await (0,_clerk_nextjs_server__WEBPACK_IMPORTED_MODULE_2__.currentUser)();\n        if (!user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Not authenticated\"\n            }, {\n                status: 401\n            });\n        }\n        const userId = user.id;\n        // Get date parameter if provided\n        const { searchParams } = new URL(request.url);\n        const date = searchParams.get(\"date\");\n        if (date) {\n            // Get specific date's log for the user\n            const logForDate = await (0,_lib_s3_service__WEBPACK_IMPORTED_MODULE_1__.getUserMoodLogForDate)(userId, date);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                log: logForDate\n            });\n        } else {\n            // Get all logs for the user\n            const logs = await (0,_lib_s3_service__WEBPACK_IMPORTED_MODULE_1__.getUserMoodLogs)(userId);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                logs\n            });\n        }\n    } catch (error) {\n        console.error(error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to fetch mood logs\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUFDaEM7SUFDRixFQUFFLE9BQU8xQixPQUFPO1FBQ2RpQixRQUFRakIsS0FBSyxDQUFDQTtRQUNkLE9BQU9WLHFEQUFZQSxDQUFDUyxJQUFJLENBQUM7WUFBRUMsT0FBTztRQUE0QixHQUFHO1lBQUVDLFFBQVE7UUFBSTtJQUNqRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdmliZWxvb3AvLi9hcHAvYXBpL21vb2QtbG9nL3JvdXRlLnRzPzE4YTciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xuaW1wb3J0IHsgc3RvcmVNb29kTG9nLCBnZXRBbGxNb29kTG9ncywgZ2V0VXNlck1vb2RMb2dzLCBoYXNVc2VyTG9nZ2VkRm9yRGF0ZSwgZ2V0VXNlck1vb2RMb2dGb3JEYXRlIH0gZnJvbSBcIkAvbGliL3MzLXNlcnZpY2VcIjtcbmltcG9ydCB7IGN1cnJlbnRVc2VyIH0gZnJvbSAnQGNsZXJrL25leHRqcy9zZXJ2ZXInO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIC8vIEdldCB1c2VyIElEIGZyb20gQ2xlcmtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgY3VycmVudFVzZXIoKTtcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIk5vdCBhdXRoZW50aWNhdGVkXCIgfSwgeyBzdGF0dXM6IDQwMSB9KTtcbiAgICB9XG4gICAgY29uc3QgdXNlcklkID0gdXNlci5pZDtcblxuICAgIGNvbnN0IHsgZW1vamksIHRleHQsIHRpbWUgfSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgIGlmICghZW1vamkgfHwgIXRleHQgfHwgIXRpbWUpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIk1pc3NpbmcgZmllbGRzXCIgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICB9XG5cbiAgICAvLyBFeHRyYWN0IGRhdGUgZnJvbSB0aW1lIChZWVlZLU1NLUREIGZvcm1hdClcbiAgICBjb25zdCBzdWJtaXR0ZWREYXRlID0gbmV3IERhdGUodGltZSk7XG4gICAgY29uc3Qgc3VibWl0dGVkRGF0ZVN0ciA9IHN1Ym1pdHRlZERhdGUudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xuXG4gICAgLy8gR2V0IHRvZGF5J3MgZGF0ZSBpbiBVVEMgKFlZWVktTU0tREQpXG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgICBjb25zdCB0b2RheVN0ciA9IG5vdy50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XG5cbiAgICAvLyBPbmx5IGFsbG93IGxvZ2dpbmcgZm9yIHRvZGF5XG4gICAgaWYgKHN1Ym1pdHRlZERhdGVTdHIgIT09IHRvZGF5U3RyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICBlcnJvcjogXCJZb3UgY2FuIG9ubHkgbG9nIHlvdXIgbW9vZCBmb3IgdG9kYXkuIExvZ2dpbmcgZm9yIHBhc3Qgb3IgZnV0dXJlIGRheXMgaXMgbm90IGFsbG93ZWQuXCIsXG4gICAgICAgIGludmFsaWREYXRlOiB0cnVlXG4gICAgICB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIHVzZXIgaGFzIGFscmVhZHkgbG9nZ2VkIGZvciB0aGlzIGRhdGVcbiAgICBjb25zdCBhbHJlYWR5TG9nZ2VkID0gYXdhaXQgaGFzVXNlckxvZ2dlZEZvckRhdGUodXNlcklkLCB0b2RheVN0cik7XG4gICAgaWYgKGFscmVhZHlMb2dnZWQpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICBlcnJvcjogXCJZb3UgaGF2ZSBhbHJlYWR5IGxvZ2dlZCB5b3VyIG1vb2QgZm9yIHRvZGF5LiBZb3UgY2FuIG9ubHkgbG9nIG9uY2UgcGVyIGRheS5cIixcbiAgICAgICAgYWxyZWFkeUxvZ2dlZDogdHJ1ZSBcbiAgICAgIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgfVxuXG4gICAgLy8gU3RvcmUgdGhlIG1vb2QgbG9nIHdpdGggdXNlciBJRFxuICAgIGF3YWl0IHN0b3JlTW9vZExvZyh7IGVtb2ppLCB0ZXh0LCB0aW1lLCB1c2VySWQgfSk7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgbWVzc2FnZTogXCJNb29kIGxvZyBzdG9yZWQgc3VjY2Vzc2Z1bGx5XCIgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiRmFpbGVkIHRvIHN0b3JlIG1vb2QgbG9nXCIgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgLy8gR2V0IHVzZXIgSUQgZnJvbSBDbGVya1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdXJyZW50VXNlcigpO1xuICAgIGlmICghdXNlcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiTm90IGF1dGhlbnRpY2F0ZWRcIiB9LCB7IHN0YXR1czogNDAxIH0pO1xuICAgIH1cbiAgICBjb25zdCB1c2VySWQgPSB1c2VyLmlkO1xuXG4gICAgLy8gR2V0IGRhdGUgcGFyYW1ldGVyIGlmIHByb3ZpZGVkXG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xuICAgIGNvbnN0IGRhdGUgPSBzZWFyY2hQYXJhbXMuZ2V0KCdkYXRlJyk7XG5cbiAgICBpZiAoZGF0ZSkge1xuICAgICAgLy8gR2V0IHNwZWNpZmljIGRhdGUncyBsb2cgZm9yIHRoZSB1c2VyXG4gICAgICBjb25zdCBsb2dGb3JEYXRlID0gYXdhaXQgZ2V0VXNlck1vb2RMb2dGb3JEYXRlKHVzZXJJZCwgZGF0ZSk7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBsb2c6IGxvZ0ZvckRhdGUgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEdldCBhbGwgbG9ncyBmb3IgdGhlIHVzZXJcbiAgICAgIGNvbnN0IGxvZ3MgPSBhd2FpdCBnZXRVc2VyTW9vZExvZ3ModXNlcklkKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBsb2dzIH0pO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJGYWlsZWQgdG8gZmV0Y2ggbW9vZCBsb2dzXCIgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgfVxufSAiXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwic3RvcmVNb29kTG9nIiwiZ2V0VXNlck1vb2RMb2dzIiwiaGFzVXNlckxvZ2dlZEZvckRhdGUiLCJnZXRVc2VyTW9vZExvZ0ZvckRhdGUiLCJjdXJyZW50VXNlciIsIlBPU1QiLCJyZXF1ZXN0IiwidXNlciIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsInVzZXJJZCIsImlkIiwiZW1vamkiLCJ0ZXh0IiwidGltZSIsInN1Ym1pdHRlZERhdGUiLCJEYXRlIiwic3VibWl0dGVkRGF0ZVN0ciIsInRvSVNPU3RyaW5nIiwic3BsaXQiLCJub3ciLCJ0b2RheVN0ciIsImludmFsaWREYXRlIiwiYWxyZWFkeUxvZ2dlZCIsIm1lc3NhZ2UiLCJjb25zb2xlIiwiR0VUIiwic2VhcmNoUGFyYW1zIiwiVVJMIiwidXJsIiwiZGF0ZSIsImdldCIsImxvZ0ZvckRhdGUiLCJsb2ciLCJsb2dzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/mood-log/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/s3-service.ts":
/*!***************************!*\
  !*** ./lib/s3-service.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addUserLikeToSong: () => (/* binding */ addUserLikeToSong),\n/* harmony export */   deleteSong: () => (/* binding */ deleteSong),\n/* harmony export */   generateSongId: () => (/* binding */ generateSongId),\n/* harmony export */   getAllMoodLogs: () => (/* binding */ getAllMoodLogs),\n/* harmony export */   getAllSongs: () => (/* binding */ getAllSongs),\n/* harmony export */   getAllSuggestions: () => (/* binding */ getAllSuggestions),\n/* harmony export */   getAudioUrl: () => (/* binding */ getAudioUrl),\n/* harmony export */   getSongMetadata: () => (/* binding */ getSongMetadata),\n/* harmony export */   getSuggestionById: () => (/* binding */ getSuggestionById),\n/* harmony export */   getUserMoodLogForDate: () => (/* binding */ getUserMoodLogForDate),\n/* harmony export */   getUserMoodLogs: () => (/* binding */ getUserMoodLogs),\n/* harmony export */   hasUserLikedSong: () => (/* binding */ hasUserLikedSong),\n/* harmony export */   hasUserLoggedForDate: () => (/* binding */ hasUserLoggedForDate),\n/* harmony export */   likeSuggestionById: () => (/* binding */ likeSuggestionById),\n/* harmony export */   storeMoodLog: () => (/* binding */ storeMoodLog),\n/* harmony export */   storeSongMetadata: () => (/* binding */ storeSongMetadata),\n/* harmony export */   storeSuggestion: () => (/* binding */ storeSuggestion),\n/* harmony export */   updateSongLikes: () => (/* binding */ updateSongLikes),\n/* harmony export */   uploadAudioFile: () => (/* binding */ uploadAudioFile)\n/* harmony export */ });\n/* harmony import */ var _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aws-sdk/client-s3 */ \"@aws-sdk/client-s3\");\n/* harmony import */ var _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _aws_sdk_s3_request_presigner__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @aws-sdk/s3-request-presigner */ \"(rsc)/./node_modules/@aws-sdk/s3-request-presigner/dist-es/index.js\");\n\n\n// S3 Client configuration\nconst s3Client = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.S3Client({\n    endpoint: \"https://hel1.your-objectstorage.com\",\n    region: \"eu-central-1\",\n    credentials: {\n        accessKeyId: \"1BY6DNARWDPSQT4DXA18\",\n        secretAccessKey: \"ieGy5o6biNPCc09iKbE55sPe01JywW8u5pFpnk8J\"\n    },\n    forcePathStyle: \"false\" === \"true\"\n});\nconst BUCKET_NAME = \"serenidad\";\n// Upload audio file to S3\nasync function uploadAudioFile(songId, file, contentType = \"audio/mpeg\") {\n    const key = `audio/${songId}.mp3`;\n    const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.PutObjectCommand({\n        Bucket: BUCKET_NAME,\n        Key: key,\n        Body: file,\n        ContentType: contentType\n    });\n    await s3Client.send(command);\n    return key;\n}\n// Store song metadata as JSON file in S3\nasync function storeSongMetadata(songId, metadata) {\n    const key = `metadata/${songId}.json`;\n    const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.PutObjectCommand({\n        Bucket: BUCKET_NAME,\n        Key: key,\n        Body: JSON.stringify(metadata),\n        ContentType: \"application/json\"\n    });\n    await s3Client.send(command);\n}\n// Get song metadata from S3\nasync function getSongMetadata(songId) {\n    try {\n        const key = `metadata/${songId}.json`;\n        const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.GetObjectCommand({\n            Bucket: BUCKET_NAME,\n            Key: key\n        });\n        const response = await s3Client.send(command);\n        const body = await response.Body?.transformToString();\n        return body ? JSON.parse(body) : null;\n    } catch (error) {\n        console.error(\"Error getting metadata:\", error);\n        return null;\n    }\n}\n// Get signed URL for audio streaming\nasync function getAudioUrl(songId) {\n    const key = `audio/${songId}.mp3`;\n    const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.GetObjectCommand({\n        Bucket: BUCKET_NAME,\n        Key: key\n    });\n    // URL expires in 1 hour\n    return await (0,_aws_sdk_s3_request_presigner__WEBPACK_IMPORTED_MODULE_1__.getSignedUrl)(s3Client, command, {\n        expiresIn: 3600\n    });\n}\n// List all songs with metadata\nasync function getAllSongs() {\n    try {\n        // List all metadata files\n        const listCommand = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.ListObjectsV2Command({\n            Bucket: BUCKET_NAME,\n            Prefix: \"metadata/\"\n        });\n        const response = await s3Client.send(listCommand);\n        const objects = response.Contents || [];\n        // If no objects found, return empty array (this is normal for new buckets)\n        if (!objects.length) {\n            return [];\n        }\n        const songs = [];\n        for (const object of objects){\n            if (object.Key && object.Key.endsWith(\".json\")) {\n                const songId = object.Key.replace(\"metadata/\", \"\").replace(\".json\", \"\");\n                const metadata = await getSongMetadata(songId);\n                if (metadata) {\n                    try {\n                        const audioUrl = await getAudioUrl(songId);\n                        songs.push({\n                            id: songId,\n                            title: metadata.title,\n                            artist: metadata.artist,\n                            audioUrl,\n                            likes: metadata.likes,\n                            uploadedAt: metadata.uploadedAt\n                        });\n                    } catch (audioError) {\n                        console.warn(`Could not get audio URL for song ${songId}:`, audioError);\n                    }\n                }\n            }\n        }\n        // Sort by upload date (newest first)\n        return songs.sort((a, b)=>new Date(b.uploadedAt).getTime() - new Date(a.uploadedAt).getTime());\n    } catch (error) {\n        // Handle the case where bucket is empty or metadata prefix doesn't exist\n        if (error.name === \"NoSuchKey\" || error.Code === \"NoSuchKey\") {\n            return [];\n        }\n        console.error(\"Error listing songs:\", error);\n        return [];\n    }\n}\n// Update song likes\nasync function updateSongLikes(songId, likes) {\n    const metadata = await getSongMetadata(songId);\n    if (metadata) {\n        metadata.likes = likes;\n        await storeSongMetadata(songId, metadata);\n    }\n}\n// Delete song and its metadata\nasync function deleteSong(songId) {\n    const audioKey = `audio/${songId}.mp3`;\n    const metadataKey = `metadata/${songId}.json`;\n    await Promise.all([\n        s3Client.send(new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.DeleteObjectCommand({\n            Bucket: BUCKET_NAME,\n            Key: audioKey\n        })),\n        s3Client.send(new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.DeleteObjectCommand({\n            Bucket: BUCKET_NAME,\n            Key: metadataKey\n        }))\n    ]);\n}\n// Generate unique song ID\nfunction generateSongId() {\n    return `song_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n}\n// Store mood log as JSON file in S3\nasync function storeMoodLog(log) {\n    const id = `mood_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    const key = `mood-logs/${id}.json`;\n    const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.PutObjectCommand({\n        Bucket: BUCKET_NAME,\n        Key: key,\n        Body: JSON.stringify(log),\n        ContentType: \"application/json\"\n    });\n    await s3Client.send(command);\n}\n// List all mood logs from S3\nasync function getAllMoodLogs() {\n    try {\n        const listCommand = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.ListObjectsV2Command({\n            Bucket: BUCKET_NAME,\n            Prefix: \"mood-logs/\"\n        });\n        const response = await s3Client.send(listCommand);\n        const objects = response.Contents || [];\n        if (!objects.length) return [];\n        const logs = [];\n        for (const object of objects){\n            if (object.Key && object.Key.endsWith(\".json\")) {\n                const getCommand = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.GetObjectCommand({\n                    Bucket: BUCKET_NAME,\n                    Key: object.Key\n                });\n                const res = await s3Client.send(getCommand);\n                const body = await res.Body?.transformToString();\n                if (body) {\n                    try {\n                        logs.push(JSON.parse(body));\n                    } catch  {}\n                }\n            }\n        }\n        // Sort by time (newest first)\n        return logs.sort((a, b)=>new Date(b.time).getTime() - new Date(a.time).getTime());\n    } catch (error) {\n        console.error(\"Error listing mood logs:\", error);\n        return [];\n    }\n}\n// Get mood logs for a specific user\nasync function getUserMoodLogs(userId) {\n    const allLogs = await getAllMoodLogs();\n    return allLogs.filter((log)=>log.userId === userId);\n}\n// Check if user has already logged for a specific date\nasync function hasUserLoggedForDate(userId, date) {\n    const userLogs = await getUserMoodLogs(userId);\n    return userLogs.some((log)=>{\n        const logDate = new Date(log.time).toISOString().split(\"T\")[0];\n        return logDate === date;\n    });\n}\n// Get user's mood log for a specific date\nasync function getUserMoodLogForDate(userId, date) {\n    const userLogs = await getUserMoodLogs(userId);\n    const logForDate = userLogs.find((log)=>{\n        const logDate = new Date(log.time).toISOString().split(\"T\")[0];\n        return logDate === date;\n    });\n    return logForDate || null;\n}\n// Check if a user has already liked a song\nasync function hasUserLikedSong(songId, userId) {\n    const metadata = await getSongMetadata(songId);\n    if (!metadata) return false;\n    return Array.isArray(metadata.likedBy) && metadata.likedBy.includes(userId);\n}\n// Add a user's like to a song (if not already liked)\nasync function addUserLikeToSong(songId, userId) {\n    const metadata = await getSongMetadata(songId);\n    if (!metadata) return null;\n    if (!Array.isArray(metadata.likedBy)) metadata.likedBy = [];\n    if (!metadata.likedBy.includes(userId)) {\n        metadata.likedBy.push(userId);\n        metadata.likes = (metadata.likes || 0) + 1;\n        await storeSongMetadata(songId, metadata);\n        return metadata.likes;\n    }\n    return metadata.likes;\n}\n// Store a suggestion as JSON file in S3\nasync function storeSuggestion(suggestion) {\n    const id = `suggestion_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    const key = `suggestions/${id}.json`;\n    const suggestionObj = {\n        id,\n        artist: suggestion.artist,\n        youtubeUrl: suggestion.youtubeUrl,\n        createdAt: new Date().toISOString(),\n        likes: 0\n    };\n    const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.PutObjectCommand({\n        Bucket: BUCKET_NAME,\n        Key: key,\n        Body: JSON.stringify(suggestionObj),\n        ContentType: \"application/json\"\n    });\n    await s3Client.send(command);\n}\n// Get a suggestion by id\nasync function getSuggestionById(id) {\n    try {\n        const key = `suggestions/${id}.json`;\n        const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.GetObjectCommand({\n            Bucket: BUCKET_NAME,\n            Key: key\n        });\n        const response = await s3Client.send(command);\n        const body = await response.Body?.transformToString();\n        return body ? JSON.parse(body) : null;\n    } catch (error) {\n        return null;\n    }\n}\n// Like a suggestion by id (increment likes)\nasync function likeSuggestionById(id) {\n    const suggestion = await getSuggestionById(id);\n    if (!suggestion) return null;\n    suggestion.likes = (suggestion.likes || 0) + 1;\n    const key = `suggestions/${id}.json`;\n    const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.PutObjectCommand({\n        Bucket: BUCKET_NAME,\n        Key: key,\n        Body: JSON.stringify(suggestion),\n        ContentType: \"application/json\"\n    });\n    await s3Client.send(command);\n    return suggestion;\n}\n// List all suggestions from S3\nasync function getAllSuggestions() {\n    try {\n        const listCommand = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.ListObjectsV2Command({\n            Bucket: BUCKET_NAME,\n            Prefix: \"suggestions/\"\n        });\n        const response = await s3Client.send(listCommand);\n        const objects = response.Contents || [];\n        if (!objects.length) return [];\n        const suggestions = [];\n        for (const object of objects){\n            if (object.Key && object.Key.endsWith(\".json\")) {\n                const getCommand = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.GetObjectCommand({\n                    Bucket: BUCKET_NAME,\n                    Key: object.Key\n                });\n                const res = await s3Client.send(getCommand);\n                const body = await res.Body?.transformToString();\n                if (body) {\n                    try {\n                        suggestions.push(JSON.parse(body));\n                    } catch  {}\n                }\n            }\n        }\n        // Sort by createdAt (newest first)\n        return suggestions.sort((a, b)=>new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n    } catch (error) {\n        console.error(\"Error listing suggestions:\", error);\n        return [];\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Z0JBQ2hDLE1BQU1qRCxPQUFPLE1BQU1rRCxJQUFJM0QsSUFBSSxFQUFFVTtnQkFDN0IsSUFBSUQsTUFBTTtvQkFDUixJQUFJO3dCQUNGZ0YsWUFBWTlELElBQUksQ0FBQ3RCLEtBQUtNLEtBQUssQ0FBQ0Y7b0JBQzlCLEVBQUUsT0FBTSxDQUFDO2dCQUNYO1lBQ0Y7UUFDRjtRQUNBLG1DQUFtQztRQUNuQyxPQUFPZ0YsWUFBWXRELElBQUksQ0FBQyxDQUFDQyxHQUFHQyxJQUFNLElBQUlDLEtBQUtELEVBQUVnRCxTQUFTLEVBQUU5QyxPQUFPLEtBQUssSUFBSUQsS0FBS0YsRUFBRWlELFNBQVMsRUFBRTlDLE9BQU87SUFDbkcsRUFBRSxPQUFPM0IsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsOEJBQThCQTtRQUM1QyxPQUFPLEVBQUU7SUFDWDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdmliZWxvb3AvLi9saWIvczMtc2VydmljZS50cz8wZGMxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFMzQ2xpZW50LCBQdXRPYmplY3RDb21tYW5kLCBHZXRPYmplY3RDb21tYW5kLCBMaXN0T2JqZWN0c1YyQ29tbWFuZCwgRGVsZXRlT2JqZWN0Q29tbWFuZCB9IGZyb20gJ0Bhd3Mtc2RrL2NsaWVudC1zMydcbmltcG9ydCB7IGdldFNpZ25lZFVybCB9IGZyb20gJ0Bhd3Mtc2RrL3MzLXJlcXVlc3QtcHJlc2lnbmVyJ1xuXG4vLyBTMyBDbGllbnQgY29uZmlndXJhdGlvblxuY29uc3QgczNDbGllbnQgPSBuZXcgUzNDbGllbnQoe1xuICBlbmRwb2ludDogcHJvY2Vzcy5lbnYuUzNfRU5EUE9JTlQsXG4gIHJlZ2lvbjogcHJvY2Vzcy5lbnYuUzNfUkVHSU9OLFxuICBjcmVkZW50aWFsczoge1xuICAgIGFjY2Vzc0tleUlkOiBwcm9jZXNzLmVudi5TM19BQ0NFU1NfS0VZX0lEISxcbiAgICBzZWNyZXRBY2Nlc3NLZXk6IHByb2Nlc3MuZW52LlMzX1NFQ1JFVF9BQ0NFU1NfS0VZISxcbiAgfSxcbiAgZm9yY2VQYXRoU3R5bGU6IHByb2Nlc3MuZW52LlMzX0ZPUkNFX1BBVEhfU1RZTEUgPT09ICd0cnVlJyxcbn0pXG5cbmNvbnN0IEJVQ0tFVF9OQU1FID0gcHJvY2Vzcy5lbnYuUzNfQlVDS0VUX05BTUUhXG5cbmV4cG9ydCBpbnRlcmZhY2UgU29uZyB7XG4gIGlkOiBzdHJpbmdcbiAgdGl0bGU6IHN0cmluZ1xuICBhcnRpc3Q6IHN0cmluZ1xuICBhdWRpb1VybDogc3RyaW5nXG4gIGxpa2VzOiBudW1iZXJcbiAgdXBsb2FkZWRBdDogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU29uZ01ldGFkYXRhIHtcbiAgdGl0bGU6IHN0cmluZ1xuICBhcnRpc3Q6IHN0cmluZ1xuICBsaWtlczogbnVtYmVyXG4gIHVwbG9hZGVkQXQ6IHN0cmluZ1xuICBsaWtlZEJ5Pzogc3RyaW5nW10gLy8gYXJyYXkgb2YgdXNlciBJRHMgd2hvIGxpa2VkIHRoaXMgc29uZ1xufVxuXG4vLyBVcGxvYWQgYXVkaW8gZmlsZSB0byBTM1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwbG9hZEF1ZGlvRmlsZShcbiAgc29uZ0lkOiBzdHJpbmcsXG4gIGZpbGU6IEJ1ZmZlcixcbiAgY29udGVudFR5cGU6IHN0cmluZyA9ICdhdWRpby9tcGVnJ1xuKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3Qga2V5ID0gYGF1ZGlvLyR7c29uZ0lkfS5tcDNgXG4gIFxuICBjb25zdCBjb21tYW5kID0gbmV3IFB1dE9iamVjdENvbW1hbmQoe1xuICAgIEJ1Y2tldDogQlVDS0VUX05BTUUsXG4gICAgS2V5OiBrZXksXG4gICAgQm9keTogZmlsZSxcbiAgICBDb250ZW50VHlwZTogY29udGVudFR5cGUsXG4gIH0pXG5cbiAgYXdhaXQgczNDbGllbnQuc2VuZChjb21tYW5kKVxuICByZXR1cm4ga2V5XG59XG5cbi8vIFN0b3JlIHNvbmcgbWV0YWRhdGEgYXMgSlNPTiBmaWxlIGluIFMzXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3RvcmVTb25nTWV0YWRhdGEoc29uZ0lkOiBzdHJpbmcsIG1ldGFkYXRhOiBTb25nTWV0YWRhdGEpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3Qga2V5ID0gYG1ldGFkYXRhLyR7c29uZ0lkfS5qc29uYFxuICBcbiAgY29uc3QgY29tbWFuZCA9IG5ldyBQdXRPYmplY3RDb21tYW5kKHtcbiAgICBCdWNrZXQ6IEJVQ0tFVF9OQU1FLFxuICAgIEtleToga2V5LFxuICAgIEJvZHk6IEpTT04uc3RyaW5naWZ5KG1ldGFkYXRhKSxcbiAgICBDb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICB9KVxuXG4gIGF3YWl0IHMzQ2xpZW50LnNlbmQoY29tbWFuZClcbn1cblxuLy8gR2V0IHNvbmcgbWV0YWRhdGEgZnJvbSBTM1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNvbmdNZXRhZGF0YShzb25nSWQ6IHN0cmluZyk6IFByb21pc2U8U29uZ01ldGFkYXRhIHwgbnVsbD4ge1xuICB0cnkge1xuICAgIGNvbnN0IGtleSA9IGBtZXRhZGF0YS8ke3NvbmdJZH0uanNvbmBcbiAgICBcbiAgICBjb25zdCBjb21tYW5kID0gbmV3IEdldE9iamVjdENvbW1hbmQoe1xuICAgICAgQnVja2V0OiBCVUNLRVRfTkFNRSxcbiAgICAgIEtleToga2V5LFxuICAgIH0pXG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHMzQ2xpZW50LnNlbmQoY29tbWFuZClcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVzcG9uc2UuQm9keT8udHJhbnNmb3JtVG9TdHJpbmcoKVxuICAgIFxuICAgIHJldHVybiBib2R5ID8gSlNPTi5wYXJzZShib2R5KSA6IG51bGxcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIG1ldGFkYXRhOicsIGVycm9yKVxuICAgIHJldHVybiBudWxsXG4gIH1cbn1cblxuLy8gR2V0IHNpZ25lZCBVUkwgZm9yIGF1ZGlvIHN0cmVhbWluZ1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEF1ZGlvVXJsKHNvbmdJZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3Qga2V5ID0gYGF1ZGlvLyR7c29uZ0lkfS5tcDNgXG4gIFxuICBjb25zdCBjb21tYW5kID0gbmV3IEdldE9iamVjdENvbW1hbmQoe1xuICAgIEJ1Y2tldDogQlVDS0VUX05BTUUsXG4gICAgS2V5OiBrZXksXG4gIH0pXG5cbiAgLy8gVVJMIGV4cGlyZXMgaW4gMSBob3VyXG4gIHJldHVybiBhd2FpdCBnZXRTaWduZWRVcmwoczNDbGllbnQsIGNvbW1hbmQsIHsgZXhwaXJlc0luOiAzNjAwIH0pXG59XG5cbi8vIExpc3QgYWxsIHNvbmdzIHdpdGggbWV0YWRhdGFcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxTb25ncygpOiBQcm9taXNlPFNvbmdbXT4ge1xuICB0cnkge1xuICAgIC8vIExpc3QgYWxsIG1ldGFkYXRhIGZpbGVzXG4gICAgY29uc3QgbGlzdENvbW1hbmQgPSBuZXcgTGlzdE9iamVjdHNWMkNvbW1hbmQoe1xuICAgICAgQnVja2V0OiBCVUNLRVRfTkFNRSxcbiAgICAgIFByZWZpeDogJ21ldGFkYXRhLycsXG4gICAgfSlcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgczNDbGllbnQuc2VuZChsaXN0Q29tbWFuZClcbiAgICBjb25zdCBvYmplY3RzID0gcmVzcG9uc2UuQ29udGVudHMgfHwgW11cblxuICAgIC8vIElmIG5vIG9iamVjdHMgZm91bmQsIHJldHVybiBlbXB0eSBhcnJheSAodGhpcyBpcyBub3JtYWwgZm9yIG5ldyBidWNrZXRzKVxuICAgIGlmICghb2JqZWN0cy5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBbXVxuICAgIH1cblxuICAgIGNvbnN0IHNvbmdzOiBTb25nW10gPSBbXVxuXG4gICAgZm9yIChjb25zdCBvYmplY3Qgb2Ygb2JqZWN0cykge1xuICAgICAgaWYgKG9iamVjdC5LZXkgJiYgb2JqZWN0LktleS5lbmRzV2l0aCgnLmpzb24nKSkge1xuICAgICAgICBjb25zdCBzb25nSWQgPSBvYmplY3QuS2V5LnJlcGxhY2UoJ21ldGFkYXRhLycsICcnKS5yZXBsYWNlKCcuanNvbicsICcnKVxuICAgICAgICBcbiAgICAgICAgY29uc3QgbWV0YWRhdGEgPSBhd2FpdCBnZXRTb25nTWV0YWRhdGEoc29uZ0lkKVxuICAgICAgICBcbiAgICAgICAgaWYgKG1ldGFkYXRhKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGF1ZGlvVXJsID0gYXdhaXQgZ2V0QXVkaW9Vcmwoc29uZ0lkKVxuICAgICAgICAgICAgc29uZ3MucHVzaCh7XG4gICAgICAgICAgICAgIGlkOiBzb25nSWQsXG4gICAgICAgICAgICAgIHRpdGxlOiBtZXRhZGF0YS50aXRsZSxcbiAgICAgICAgICAgICAgYXJ0aXN0OiBtZXRhZGF0YS5hcnRpc3QsXG4gICAgICAgICAgICAgIGF1ZGlvVXJsLFxuICAgICAgICAgICAgICBsaWtlczogbWV0YWRhdGEubGlrZXMsXG4gICAgICAgICAgICAgIHVwbG9hZGVkQXQ6IG1ldGFkYXRhLnVwbG9hZGVkQXQsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0gY2F0Y2ggKGF1ZGlvRXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgQ291bGQgbm90IGdldCBhdWRpbyBVUkwgZm9yIHNvbmcgJHtzb25nSWR9OmAsIGF1ZGlvRXJyb3IpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIFNvcnQgYnkgdXBsb2FkIGRhdGUgKG5ld2VzdCBmaXJzdClcbiAgICByZXR1cm4gc29uZ3Muc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYi51cGxvYWRlZEF0KS5nZXRUaW1lKCkgLSBuZXcgRGF0ZShhLnVwbG9hZGVkQXQpLmdldFRpbWUoKSlcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIC8vIEhhbmRsZSB0aGUgY2FzZSB3aGVyZSBidWNrZXQgaXMgZW1wdHkgb3IgbWV0YWRhdGEgcHJlZml4IGRvZXNuJ3QgZXhpc3RcbiAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ05vU3VjaEtleScgfHwgZXJyb3IuQ29kZSA9PT0gJ05vU3VjaEtleScpIHtcbiAgICAgIHJldHVybiBbXVxuICAgIH1cbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsaXN0aW5nIHNvbmdzOicsIGVycm9yKVxuICAgIHJldHVybiBbXVxuICB9XG59XG5cbi8vIFVwZGF0ZSBzb25nIGxpa2VzXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU29uZ0xpa2VzKHNvbmdJZDogc3RyaW5nLCBsaWtlczogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IG1ldGFkYXRhID0gYXdhaXQgZ2V0U29uZ01ldGFkYXRhKHNvbmdJZClcbiAgaWYgKG1ldGFkYXRhKSB7XG4gICAgbWV0YWRhdGEubGlrZXMgPSBsaWtlc1xuICAgIGF3YWl0IHN0b3JlU29uZ01ldGFkYXRhKHNvbmdJZCwgbWV0YWRhdGEpXG4gIH1cbn1cblxuLy8gRGVsZXRlIHNvbmcgYW5kIGl0cyBtZXRhZGF0YVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVNvbmcoc29uZ0lkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgYXVkaW9LZXkgPSBgYXVkaW8vJHtzb25nSWR9Lm1wM2BcbiAgY29uc3QgbWV0YWRhdGFLZXkgPSBgbWV0YWRhdGEvJHtzb25nSWR9Lmpzb25gXG5cbiAgYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgIHMzQ2xpZW50LnNlbmQobmV3IERlbGV0ZU9iamVjdENvbW1hbmQoeyBCdWNrZXQ6IEJVQ0tFVF9OQU1FLCBLZXk6IGF1ZGlvS2V5IH0pKSxcbiAgICBzM0NsaWVudC5zZW5kKG5ldyBEZWxldGVPYmplY3RDb21tYW5kKHsgQnVja2V0OiBCVUNLRVRfTkFNRSwgS2V5OiBtZXRhZGF0YUtleSB9KSlcbiAgXSlcbn1cblxuLy8gR2VuZXJhdGUgdW5pcXVlIHNvbmcgSURcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVNvbmdJZCgpOiBzdHJpbmcge1xuICByZXR1cm4gYHNvbmdfJHtEYXRlLm5vdygpfV8ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gXG59XG5cbi8vIFN0b3JlIG1vb2QgbG9nIGFzIEpTT04gZmlsZSBpbiBTM1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN0b3JlTW9vZExvZyhsb2c6IHsgZW1vamk6IHN0cmluZzsgdGV4dDogc3RyaW5nOyB0aW1lOiBzdHJpbmc7IHVzZXJJZDogc3RyaW5nIH0pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgaWQgPSBgbW9vZF8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWA7XG4gIGNvbnN0IGtleSA9IGBtb29kLWxvZ3MvJHtpZH0uanNvbmA7XG4gIGNvbnN0IGNvbW1hbmQgPSBuZXcgUHV0T2JqZWN0Q29tbWFuZCh7XG4gICAgQnVja2V0OiBCVUNLRVRfTkFNRSxcbiAgICBLZXk6IGtleSxcbiAgICBCb2R5OiBKU09OLnN0cmluZ2lmeShsb2cpLFxuICAgIENvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vanNvbicsXG4gIH0pO1xuICBhd2FpdCBzM0NsaWVudC5zZW5kKGNvbW1hbmQpO1xufVxuXG4vLyBMaXN0IGFsbCBtb29kIGxvZ3MgZnJvbSBTM1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbE1vb2RMb2dzKCk6IFByb21pc2U8e2Vtb2ppOiBzdHJpbmcsIHRleHQ6IHN0cmluZywgdGltZTogc3RyaW5nLCB1c2VySWQ6IHN0cmluZ31bXT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGxpc3RDb21tYW5kID0gbmV3IExpc3RPYmplY3RzVjJDb21tYW5kKHtcbiAgICAgIEJ1Y2tldDogQlVDS0VUX05BTUUsXG4gICAgICBQcmVmaXg6ICdtb29kLWxvZ3MvJyxcbiAgICB9KTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHMzQ2xpZW50LnNlbmQobGlzdENvbW1hbmQpO1xuICAgIGNvbnN0IG9iamVjdHMgPSByZXNwb25zZS5Db250ZW50cyB8fCBbXTtcbiAgICBpZiAoIW9iamVjdHMubGVuZ3RoKSByZXR1cm4gW107XG4gICAgY29uc3QgbG9nczoge2Vtb2ppOiBzdHJpbmcsIHRleHQ6IHN0cmluZywgdGltZTogc3RyaW5nLCB1c2VySWQ6IHN0cmluZ31bXSA9IFtdO1xuICAgIGZvciAoY29uc3Qgb2JqZWN0IG9mIG9iamVjdHMpIHtcbiAgICAgIGlmIChvYmplY3QuS2V5ICYmIG9iamVjdC5LZXkuZW5kc1dpdGgoJy5qc29uJykpIHtcbiAgICAgICAgY29uc3QgZ2V0Q29tbWFuZCA9IG5ldyBHZXRPYmplY3RDb21tYW5kKHtcbiAgICAgICAgICBCdWNrZXQ6IEJVQ0tFVF9OQU1FLFxuICAgICAgICAgIEtleTogb2JqZWN0LktleSxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHMzQ2xpZW50LnNlbmQoZ2V0Q29tbWFuZCk7XG4gICAgICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXMuQm9keT8udHJhbnNmb3JtVG9TdHJpbmcoKTtcbiAgICAgICAgaWYgKGJvZHkpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgbG9ncy5wdXNoKEpTT04ucGFyc2UoYm9keSkpO1xuICAgICAgICAgIH0gY2F0Y2gge31cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICAvLyBTb3J0IGJ5IHRpbWUgKG5ld2VzdCBmaXJzdClcbiAgICByZXR1cm4gbG9ncy5zb3J0KChhLCBiKSA9PiBuZXcgRGF0ZShiLnRpbWUpLmdldFRpbWUoKSAtIG5ldyBEYXRlKGEudGltZSkuZ2V0VGltZSgpKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsaXN0aW5nIG1vb2QgbG9nczonLCBlcnJvcik7XG4gICAgcmV0dXJuIFtdO1xuICB9XG59XG5cbi8vIEdldCBtb29kIGxvZ3MgZm9yIGEgc3BlY2lmaWMgdXNlclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFVzZXJNb29kTG9ncyh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8e2Vtb2ppOiBzdHJpbmcsIHRleHQ6IHN0cmluZywgdGltZTogc3RyaW5nLCB1c2VySWQ6IHN0cmluZ31bXT4ge1xuICBjb25zdCBhbGxMb2dzID0gYXdhaXQgZ2V0QWxsTW9vZExvZ3MoKTtcbiAgcmV0dXJuIGFsbExvZ3MuZmlsdGVyKGxvZyA9PiBsb2cudXNlcklkID09PSB1c2VySWQpO1xufVxuXG4vLyBDaGVjayBpZiB1c2VyIGhhcyBhbHJlYWR5IGxvZ2dlZCBmb3IgYSBzcGVjaWZpYyBkYXRlXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFzVXNlckxvZ2dlZEZvckRhdGUodXNlcklkOiBzdHJpbmcsIGRhdGU6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICBjb25zdCB1c2VyTG9ncyA9IGF3YWl0IGdldFVzZXJNb29kTG9ncyh1c2VySWQpO1xuICByZXR1cm4gdXNlckxvZ3Muc29tZShsb2cgPT4ge1xuICAgIGNvbnN0IGxvZ0RhdGUgPSBuZXcgRGF0ZShsb2cudGltZSkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xuICAgIHJldHVybiBsb2dEYXRlID09PSBkYXRlO1xuICB9KTtcbn1cblxuLy8gR2V0IHVzZXIncyBtb29kIGxvZyBmb3IgYSBzcGVjaWZpYyBkYXRlXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlck1vb2RMb2dGb3JEYXRlKHVzZXJJZDogc3RyaW5nLCBkYXRlOiBzdHJpbmcpOiBQcm9taXNlPHtlbW9qaTogc3RyaW5nLCB0ZXh0OiBzdHJpbmcsIHRpbWU6IHN0cmluZywgdXNlcklkOiBzdHJpbmd9IHwgbnVsbD4ge1xuICBjb25zdCB1c2VyTG9ncyA9IGF3YWl0IGdldFVzZXJNb29kTG9ncyh1c2VySWQpO1xuICBjb25zdCBsb2dGb3JEYXRlID0gdXNlckxvZ3MuZmluZChsb2cgPT4ge1xuICAgIGNvbnN0IGxvZ0RhdGUgPSBuZXcgRGF0ZShsb2cudGltZSkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xuICAgIHJldHVybiBsb2dEYXRlID09PSBkYXRlO1xuICB9KTtcbiAgcmV0dXJuIGxvZ0ZvckRhdGUgfHwgbnVsbDtcbn1cblxuLy8gQ2hlY2sgaWYgYSB1c2VyIGhhcyBhbHJlYWR5IGxpa2VkIGEgc29uZ1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhc1VzZXJMaWtlZFNvbmcoc29uZ0lkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIGNvbnN0IG1ldGFkYXRhID0gYXdhaXQgZ2V0U29uZ01ldGFkYXRhKHNvbmdJZCk7XG4gIGlmICghbWV0YWRhdGEpIHJldHVybiBmYWxzZTtcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkobWV0YWRhdGEubGlrZWRCeSkgJiYgbWV0YWRhdGEubGlrZWRCeS5pbmNsdWRlcyh1c2VySWQpO1xufVxuXG4vLyBBZGQgYSB1c2VyJ3MgbGlrZSB0byBhIHNvbmcgKGlmIG5vdCBhbHJlYWR5IGxpa2VkKVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFkZFVzZXJMaWtlVG9Tb25nKHNvbmdJZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8bnVtYmVyIHwgbnVsbD4ge1xuICBjb25zdCBtZXRhZGF0YSA9IGF3YWl0IGdldFNvbmdNZXRhZGF0YShzb25nSWQpO1xuICBpZiAoIW1ldGFkYXRhKSByZXR1cm4gbnVsbDtcbiAgaWYgKCFBcnJheS5pc0FycmF5KG1ldGFkYXRhLmxpa2VkQnkpKSBtZXRhZGF0YS5saWtlZEJ5ID0gW107XG4gIGlmICghbWV0YWRhdGEubGlrZWRCeS5pbmNsdWRlcyh1c2VySWQpKSB7XG4gICAgbWV0YWRhdGEubGlrZWRCeS5wdXNoKHVzZXJJZCk7XG4gICAgbWV0YWRhdGEubGlrZXMgPSAobWV0YWRhdGEubGlrZXMgfHwgMCkgKyAxO1xuICAgIGF3YWl0IHN0b3JlU29uZ01ldGFkYXRhKHNvbmdJZCwgbWV0YWRhdGEpO1xuICAgIHJldHVybiBtZXRhZGF0YS5saWtlcztcbiAgfVxuICByZXR1cm4gbWV0YWRhdGEubGlrZXM7XG59IFxuXG4vLyBTdWdnZXN0aW9uIGludGVyZmFjZVxuZXhwb3J0IGludGVyZmFjZSBTdWdnZXN0aW9uIHtcbiAgaWQ6IHN0cmluZztcbiAgYXJ0aXN0OiBzdHJpbmc7XG4gIHlvdXR1YmVVcmw6IHN0cmluZztcbiAgY3JlYXRlZEF0OiBzdHJpbmc7XG4gIGxpa2VzOiBudW1iZXI7XG59XG5cbi8vIFN0b3JlIGEgc3VnZ2VzdGlvbiBhcyBKU09OIGZpbGUgaW4gUzNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdG9yZVN1Z2dlc3Rpb24oc3VnZ2VzdGlvbjogeyBhcnRpc3Q6IHN0cmluZzsgeW91dHViZVVybDogc3RyaW5nIH0pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgaWQgPSBgc3VnZ2VzdGlvbl8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWA7XG4gIGNvbnN0IGtleSA9IGBzdWdnZXN0aW9ucy8ke2lkfS5qc29uYDtcbiAgY29uc3Qgc3VnZ2VzdGlvbk9iajogU3VnZ2VzdGlvbiA9IHtcbiAgICBpZCxcbiAgICBhcnRpc3Q6IHN1Z2dlc3Rpb24uYXJ0aXN0LFxuICAgIHlvdXR1YmVVcmw6IHN1Z2dlc3Rpb24ueW91dHViZVVybCxcbiAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICBsaWtlczogMCxcbiAgfTtcbiAgY29uc3QgY29tbWFuZCA9IG5ldyBQdXRPYmplY3RDb21tYW5kKHtcbiAgICBCdWNrZXQ6IEJVQ0tFVF9OQU1FLFxuICAgIEtleToga2V5LFxuICAgIEJvZHk6IEpTT04uc3RyaW5naWZ5KHN1Z2dlc3Rpb25PYmopLFxuICAgIENvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vanNvbicsXG4gIH0pO1xuICBhd2FpdCBzM0NsaWVudC5zZW5kKGNvbW1hbmQpO1xufVxuXG4vLyBHZXQgYSBzdWdnZXN0aW9uIGJ5IGlkXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U3VnZ2VzdGlvbkJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8U3VnZ2VzdGlvbiB8IG51bGw+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBrZXkgPSBgc3VnZ2VzdGlvbnMvJHtpZH0uanNvbmA7XG4gICAgY29uc3QgY29tbWFuZCA9IG5ldyBHZXRPYmplY3RDb21tYW5kKHtcbiAgICAgIEJ1Y2tldDogQlVDS0VUX05BTUUsXG4gICAgICBLZXk6IGtleSxcbiAgICB9KTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHMzQ2xpZW50LnNlbmQoY29tbWFuZCk7XG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlc3BvbnNlLkJvZHk/LnRyYW5zZm9ybVRvU3RyaW5nKCk7XG4gICAgcmV0dXJuIGJvZHkgPyBKU09OLnBhcnNlKGJvZHkpIDogbnVsbDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG4vLyBMaWtlIGEgc3VnZ2VzdGlvbiBieSBpZCAoaW5jcmVtZW50IGxpa2VzKVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpa2VTdWdnZXN0aW9uQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxTdWdnZXN0aW9uIHwgbnVsbD4ge1xuICBjb25zdCBzdWdnZXN0aW9uID0gYXdhaXQgZ2V0U3VnZ2VzdGlvbkJ5SWQoaWQpO1xuICBpZiAoIXN1Z2dlc3Rpb24pIHJldHVybiBudWxsO1xuICBzdWdnZXN0aW9uLmxpa2VzID0gKHN1Z2dlc3Rpb24ubGlrZXMgfHwgMCkgKyAxO1xuICBjb25zdCBrZXkgPSBgc3VnZ2VzdGlvbnMvJHtpZH0uanNvbmA7XG4gIGNvbnN0IGNvbW1hbmQgPSBuZXcgUHV0T2JqZWN0Q29tbWFuZCh7XG4gICAgQnVja2V0OiBCVUNLRVRfTkFNRSxcbiAgICBLZXk6IGtleSxcbiAgICBCb2R5OiBKU09OLnN0cmluZ2lmeShzdWdnZXN0aW9uKSxcbiAgICBDb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICB9KTtcbiAgYXdhaXQgczNDbGllbnQuc2VuZChjb21tYW5kKTtcbiAgcmV0dXJuIHN1Z2dlc3Rpb247XG59XG5cbi8vIExpc3QgYWxsIHN1Z2dlc3Rpb25zIGZyb20gUzNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxTdWdnZXN0aW9ucygpOiBQcm9taXNlPFN1Z2dlc3Rpb25bXT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGxpc3RDb21tYW5kID0gbmV3IExpc3RPYmplY3RzVjJDb21tYW5kKHtcbiAgICAgIEJ1Y2tldDogQlVDS0VUX05BTUUsXG4gICAgICBQcmVmaXg6ICdzdWdnZXN0aW9ucy8nLFxuICAgIH0pO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgczNDbGllbnQuc2VuZChsaXN0Q29tbWFuZCk7XG4gICAgY29uc3Qgb2JqZWN0cyA9IHJlc3BvbnNlLkNvbnRlbnRzIHx8IFtdO1xuICAgIGlmICghb2JqZWN0cy5sZW5ndGgpIHJldHVybiBbXTtcbiAgICBjb25zdCBzdWdnZXN0aW9uczogU3VnZ2VzdGlvbltdID0gW107XG4gICAgZm9yIChjb25zdCBvYmplY3Qgb2Ygb2JqZWN0cykge1xuICAgICAgaWYgKG9iamVjdC5LZXkgJiYgb2JqZWN0LktleS5lbmRzV2l0aCgnLmpzb24nKSkge1xuICAgICAgICBjb25zdCBnZXRDb21tYW5kID0gbmV3IEdldE9iamVjdENvbW1hbmQoe1xuICAgICAgICAgIEJ1Y2tldDogQlVDS0VUX05BTUUsXG4gICAgICAgICAgS2V5OiBvYmplY3QuS2V5LFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgczNDbGllbnQuc2VuZChnZXRDb21tYW5kKTtcbiAgICAgICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcy5Cb2R5Py50cmFuc2Zvcm1Ub1N0cmluZygpO1xuICAgICAgICBpZiAoYm9keSkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKEpTT04ucGFyc2UoYm9keSkpO1xuICAgICAgICAgIH0gY2F0Y2gge31cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICAvLyBTb3J0IGJ5IGNyZWF0ZWRBdCAobmV3ZXN0IGZpcnN0KVxuICAgIHJldHVybiBzdWdnZXN0aW9ucy5zb3J0KChhLCBiKSA9PiBuZXcgRGF0ZShiLmNyZWF0ZWRBdCkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYS5jcmVhdGVkQXQpLmdldFRpbWUoKSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlzdGluZyBzdWdnZXN0aW9uczonLCBlcnJvcik7XG4gICAgcmV0dXJuIFtdO1xuICB9XG59ICJdLCJuYW1lcyI6WyJTM0NsaWVudCIsIlB1dE9iamVjdENvbW1hbmQiLCJHZXRPYmplY3RDb21tYW5kIiwiTGlzdE9iamVjdHNWMkNvbW1hbmQiLCJEZWxldGVPYmplY3RDb21tYW5kIiwiZ2V0U2lnbmVkVXJsIiwiczNDbGllbnQiLCJlbmRwb2ludCIsInByb2Nlc3MiLCJlbnYiLCJTM19FTkRQT0lOVCIsInJlZ2lvbiIsIlMzX1JFR0lPTiIsImNyZWRlbnRpYWxzIiwiYWNjZXNzS2V5SWQiLCJTM19BQ0NFU1NfS0VZX0lEIiwic2VjcmV0QWNjZXNzS2V5IiwiUzNfU0VDUkVUX0FDQ0VTU19LRVkiLCJmb3JjZVBhdGhTdHlsZSIsIlMzX0ZPUkNFX1BBVEhfU1RZTEUiLCJCVUNLRVRfTkFNRSIsIlMzX0JVQ0tFVF9OQU1FIiwidXBsb2FkQXVkaW9GaWxlIiwic29uZ0lkIiwiZmlsZSIsImNvbnRlbnRUeXBlIiwia2V5IiwiY29tbWFuZCIsIkJ1Y2tldCIsIktleSIsIkJvZHkiLCJDb250ZW50VHlwZSIsInNlbmQiLCJzdG9yZVNvbmdNZXRhZGF0YSIsIm1ldGFkYXRhIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldFNvbmdNZXRhZGF0YSIsInJlc3BvbnNlIiwiYm9keSIsInRyYW5zZm9ybVRvU3RyaW5nIiwicGFyc2UiLCJlcnJvciIsImNvbnNvbGUiLCJnZXRBdWRpb1VybCIsImV4cGlyZXNJbiIsImdldEFsbFNvbmdzIiwibGlzdENvbW1hbmQiLCJQcmVmaXgiLCJvYmplY3RzIiwiQ29udGVudHMiLCJsZW5ndGgiLCJzb25ncyIsIm9iamVjdCIsImVuZHNXaXRoIiwicmVwbGFjZSIsImF1ZGlvVXJsIiwicHVzaCIsImlkIiwidGl0bGUiLCJhcnRpc3QiLCJsaWtlcyIsInVwbG9hZGVkQXQiLCJhdWRpb0Vycm9yIiwid2FybiIsInNvcnQiLCJhIiwiYiIsIkRhdGUiLCJnZXRUaW1lIiwibmFtZSIsIkNvZGUiLCJ1cGRhdGVTb25nTGlrZXMiLCJkZWxldGVTb25nIiwiYXVkaW9LZXkiLCJtZXRhZGF0YUtleSIsIlByb21pc2UiLCJhbGwiLCJnZW5lcmF0ZVNvbmdJZCIsIm5vdyIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0ciIsInN0b3JlTW9vZExvZyIsImxvZyIsImdldEFsbE1vb2RMb2dzIiwibG9ncyIsImdldENvbW1hbmQiLCJyZXMiLCJ0aW1lIiwiZ2V0VXNlck1vb2RMb2dzIiwidXNlcklkIiwiYWxsTG9ncyIsImZpbHRlciIsImhhc1VzZXJMb2dnZWRGb3JEYXRlIiwiZGF0ZSIsInVzZXJMb2dzIiwic29tZSIsImxvZ0RhdGUiLCJ0b0lTT1N0cmluZyIsInNwbGl0IiwiZ2V0VXNlck1vb2RMb2dGb3JEYXRlIiwibG9nRm9yRGF0ZSIsImZpbmQiLCJoYXNVc2VyTGlrZWRTb25nIiwiQXJyYXkiLCJpc0FycmF5IiwibGlrZWRCeSIsImluY2x1ZGVzIiwiYWRkVXNlckxpa2VUb1NvbmciLCJzdG9yZVN1Z2dlc3Rpb24iLCJzdWdnZXN0aW9uIiwic3VnZ2VzdGlvbk9iaiIsInlvdXR1YmVVcmwiLCJjcmVhdGVkQXQiLCJnZXRTdWdnZXN0aW9uQnlJZCIsImxpa2VTdWdnZXN0aW9uQnlJZCIsImdldEFsbFN1Z2dlc3Rpb25zIiwic3VnZ2VzdGlvbnMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/s3-service.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@clerk","vendor-chunks/next","vendor-chunks/tslib","vendor-chunks/cookie","vendor-chunks/map-obj","vendor-chunks/no-case","vendor-chunks/lower-case","vendor-chunks/snakecase-keys","vendor-chunks/snake-case","vendor-chunks/dot-case","vendor-chunks/@smithy","vendor-chunks/@aws-sdk"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmood-log%2Froute&page=%2Fapi%2Fmood-log%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmood-log%2Froute.ts&appDir=%2FUsers%2Faditysaib%2FDocuments%2FVibe-loop%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Faditysaib%2FDocuments%2FVibe-loop&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();